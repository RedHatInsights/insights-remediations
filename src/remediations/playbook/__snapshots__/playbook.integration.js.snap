// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`playbooks generate playbook for remediation with zero issues does not freak out 1`] = `""`;

exports[`playbooks generate playbook specifying 1 host and using localhost flag 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# test namespace
# https://console.redhat.com/insights/remediations/5e6d136e-ea32-46e4-a350-325ef41790f4
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Fixes test:ping
# Identifier: (test:ping,fix)
# Version: unknown
- name: ping
  hosts: \\"localhost\\"
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlZCZDFWQldVaHBSM0ZqZG5jMU9FUXJhalZ3VGtGUmFrTXpRUzh6VVdwUVow
      MXZTM0JYZFZVeWNuaExWVkpJYTI5VVRHVkdTRmczVDFkVU1Ya0tlRzR6WWtOMU1FeHdXRWhDWjBk
      Vkt6VndTRFF3ZGswdmMzVlhjblJZYjNJckwydHRja3BFWkZWMU5IWkpaMmt4VW1aQmNsTmxabk5H
      TTFCdlIxWnFjUW8yWkhVM1RuQmhOazlQT1cxWFJGWXZPRnBqYW14SVdrVkpUVU5OYlRKamRqQnVk
      RmhuWTJwSmJrTmhlbmtyTVhkNmFHaExUMFJNV1RKTE9WZ3dPVUkzQ2xKR01HMWpjR0ZpUVZsclJH
      ZHpWVVYyU0RCM2RXUTRkRkpuZW5sWVFXWTJZMmw0TTBabVoyOTVTa2d2ZUdFd01uWkZRbFZGUWxG
      dFUzVlhjMEk0ZHpNS2FXaFVVVVpyVEN0NE1uQnliSGxXUWtWd2FqTnlRMmhZY3poMVVsbEJMeTlU
      UjNka1owSndkMlpVWm01ckswUk5VVGRuUzJKbFYyVnhabFFyVlRNNUt3cGFaMGhoTW1WbFkzZFJh
      MmhsVEUwNFkzVkhha012ZFVFNVpWSnhablJRY1RCcU0yVllNWGxGYjNOR1pHTldOekJuYzFJd1dH
      TjBSazlDWTJWSVVXNXRDak4xVjBSVVRqRmllV0kyWVZaYVFqZzVUM1JWTjFCU1preHhSMVkyYjBj
      MU5WQkZVRkV6VVRCSVRXMVRlRWt3WlRjNWNIUXhXVmxHUkhad2FtNXBjSGtLTjJ0aUwzbERObU5s
      ZFZGTWNraHpLMjVSYkVKQ05VSk5OV0ZQVFN0emMwSkpSM1JJZGtWUFRqWTFOMGw2WlRKaGNqRnBj
      bTh5Y1V4TVFXRkJVMHBrVEFwbU9ERmlPSGxFY1hCeVpFOVZaV1ZMYzBncldYazFhekZGVVUwdlRE
      QXpjeTkzVm1wa1NqQktiV2xFVlhwd1pXa3dkVXRCYmxGUWRFdElRbFJsYmtsSENtRnBMMU5KYlRO
      RWMxcHlNRTV4TnpsYVVWVjBiVEpYY0c5bGVrTkZla3ByVlN0eU4weFhjRWg1Y21SdE5VMVpOVzV4
      TW1sb2JsaEVNRFZHTkhsbGIwVUtObmh4VlRGYWJDdERXSEZOYTNOblJUWklZV0l2VDFscVpHRmFX
      VUZwUm5aUlJFOXhPVkU1V1ZVNE5rSnRXSGRwUzNoalltNVRWREJ6VnpZeFVUaFpWd3BWVUVSblpT
      dFJMMHhSUFQwS1BVVnpWVWNLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - ping:

- name: run insights
  hosts: \\"localhost\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook specifying 1 host, making some issues in the playbook hostless 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# test namespace
# https://console.redhat.com/insights/remediations/5e6d136e-ea32-46e4-a350-325ef41790f4
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Fixes test:ping
# Identifier: (test:ping,fix)
# Version: unknown
- name: ping
  hosts: \\"9dae9304-86a8-4f66-baa3-a1b27dfdd479.ansible.example.com\\"
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlZCZDFWQldVaHBSM0ZqZG5jMU9FUXJhalZ3VGtGUmFrTXpRUzh6VVdwUVow
      MXZTM0JYZFZVeWNuaExWVkpJYTI5VVRHVkdTRmczVDFkVU1Ya0tlRzR6WWtOMU1FeHdXRWhDWjBk
      Vkt6VndTRFF3ZGswdmMzVlhjblJZYjNJckwydHRja3BFWkZWMU5IWkpaMmt4VW1aQmNsTmxabk5H
      TTFCdlIxWnFjUW8yWkhVM1RuQmhOazlQT1cxWFJGWXZPRnBqYW14SVdrVkpUVU5OYlRKamRqQnVk
      RmhuWTJwSmJrTmhlbmtyTVhkNmFHaExUMFJNV1RKTE9WZ3dPVUkzQ2xKR01HMWpjR0ZpUVZsclJH
      ZHpWVVYyU0RCM2RXUTRkRkpuZW5sWVFXWTJZMmw0TTBabVoyOTVTa2d2ZUdFd01uWkZRbFZGUWxG
      dFUzVlhjMEk0ZHpNS2FXaFVVVVpyVEN0NE1uQnliSGxXUWtWd2FqTnlRMmhZY3poMVVsbEJMeTlU
      UjNka1owSndkMlpVWm01ckswUk5VVGRuUzJKbFYyVnhabFFyVlRNNUt3cGFaMGhoTW1WbFkzZFJh
      MmhsVEUwNFkzVkhha012ZFVFNVpWSnhablJRY1RCcU0yVllNWGxGYjNOR1pHTldOekJuYzFJd1dH
      TjBSazlDWTJWSVVXNXRDak4xVjBSVVRqRmllV0kyWVZaYVFqZzVUM1JWTjFCU1preHhSMVkyYjBj
      MU5WQkZVRkV6VVRCSVRXMVRlRWt3WlRjNWNIUXhXVmxHUkhad2FtNXBjSGtLTjJ0aUwzbERObU5s
      ZFZGTWNraHpLMjVSYkVKQ05VSk5OV0ZQVFN0emMwSkpSM1JJZGtWUFRqWTFOMGw2WlRKaGNqRnBj
      bTh5Y1V4TVFXRkJVMHBrVEFwbU9ERmlPSGxFY1hCeVpFOVZaV1ZMYzBncldYazFhekZGVVUwdlRE
      QXpjeTkzVm1wa1NqQktiV2xFVlhwd1pXa3dkVXRCYmxGUWRFdElRbFJsYmtsSENtRnBMMU5KYlRO
      RWMxcHlNRTV4TnpsYVVWVjBiVEpYY0c5bGVrTkZla3ByVlN0eU4weFhjRWg1Y21SdE5VMVpOVzV4
      TW1sb2JsaEVNRFZHTkhsbGIwVUtObmh4VlRGYWJDdERXSEZOYTNOblJUWklZV0l2VDFscVpHRmFX
      VUZwUm5aUlJFOXhPVkU1V1ZVNE5rSnRXSGRwUzNoalltNVRWREJ6VnpZeFVUaFpWd3BWVUVSblpT
      dFJMMHhSUFQwS1BVVnpWVWNLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - ping:

- name: run insights
  hosts: \\"9dae9304-86a8-4f66-baa3-a1b27dfdd479.ansible.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook specifying 2 hosts, 1 included in the remediation and 1 not 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# test namespace
# https://console.redhat.com/insights/remediations/5e6d136e-ea32-46e4-a350-325ef41790f4
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Fixes test:ping
# Identifier: (test:ping,fix)
# Version: unknown
- name: ping
  hosts: \\"9dae9304-86a8-4f66-baa3-a1b27dfdd479.ansible.example.com\\"
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlZCZDFWQldVaHBSM0ZqZG5jMU9FUXJhalZ3VGtGUmFrTXpRUzh6VVdwUVow
      MXZTM0JYZFZVeWNuaExWVkpJYTI5VVRHVkdTRmczVDFkVU1Ya0tlRzR6WWtOMU1FeHdXRWhDWjBk
      Vkt6VndTRFF3ZGswdmMzVlhjblJZYjNJckwydHRja3BFWkZWMU5IWkpaMmt4VW1aQmNsTmxabk5H
      TTFCdlIxWnFjUW8yWkhVM1RuQmhOazlQT1cxWFJGWXZPRnBqYW14SVdrVkpUVU5OYlRKamRqQnVk
      RmhuWTJwSmJrTmhlbmtyTVhkNmFHaExUMFJNV1RKTE9WZ3dPVUkzQ2xKR01HMWpjR0ZpUVZsclJH
      ZHpWVVYyU0RCM2RXUTRkRkpuZW5sWVFXWTJZMmw0TTBabVoyOTVTa2d2ZUdFd01uWkZRbFZGUWxG
      dFUzVlhjMEk0ZHpNS2FXaFVVVVpyVEN0NE1uQnliSGxXUWtWd2FqTnlRMmhZY3poMVVsbEJMeTlU
      UjNka1owSndkMlpVWm01ckswUk5VVGRuUzJKbFYyVnhabFFyVlRNNUt3cGFaMGhoTW1WbFkzZFJh
      MmhsVEUwNFkzVkhha012ZFVFNVpWSnhablJRY1RCcU0yVllNWGxGYjNOR1pHTldOekJuYzFJd1dH
      TjBSazlDWTJWSVVXNXRDak4xVjBSVVRqRmllV0kyWVZaYVFqZzVUM1JWTjFCU1preHhSMVkyYjBj
      MU5WQkZVRkV6VVRCSVRXMVRlRWt3WlRjNWNIUXhXVmxHUkhad2FtNXBjSGtLTjJ0aUwzbERObU5s
      ZFZGTWNraHpLMjVSYkVKQ05VSk5OV0ZQVFN0emMwSkpSM1JJZGtWUFRqWTFOMGw2WlRKaGNqRnBj
      bTh5Y1V4TVFXRkJVMHBrVEFwbU9ERmlPSGxFY1hCeVpFOVZaV1ZMYzBncldYazFhekZGVVUwdlRE
      QXpjeTkzVm1wa1NqQktiV2xFVlhwd1pXa3dkVXRCYmxGUWRFdElRbFJsYmtsSENtRnBMMU5KYlRO
      RWMxcHlNRTV4TnpsYVVWVjBiVEpYY0c5bGVrTkZla3ByVlN0eU4weFhjRWg1Y21SdE5VMVpOVzV4
      TW1sb2JsaEVNRFZHTkhsbGIwVUtObmh4VlRGYWJDdERXSEZOYTNOblJUWklZV0l2VDFscVpHRmFX
      VUZwUm5aUlJFOXhPVkU1V1ZVNE5rSnRXSGRwUzNoalltNVRWREJ6VnpZeFVUaFpWd3BWVUVSblpT
      dFJMMHhSUFQwS1BVVnpWVWNLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - ping:

- name: run insights
  hosts: \\"9dae9304-86a8-4f66-baa3-a1b27dfdd479.ansible.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook specifying only 1 of its hosts 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# many systems
# https://console.redhat.com/insights/remediations/c3f9f751-4bcc-4222-9b83-77f5e6e603da
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Upgrade packages affected by CVE-2017-5715
# Identifier: (vulnerabilities:CVE-2017-5715,fix)
# Version: test
- name: update vulnerable packages
  hosts: \\"84762eb3-0bbb-4bd8-ab11-f420c50e9000.example.com\\"
  vars:
    insights_issues: \\"--cve CVE-2017-5715\\"
    insights_signature_exclude: /hosts,/vars/insights_signature,/vars/insights_issues
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldWTmFUMGM0ZG5jMU9FUXJhalZ3VGtGUmFFVnpRUzh2VW1OSFFU
      TjFLM2RDVFdOYWJTOTNheTlOVVVKRGVua3pRWEZsZG1Jd1NIa0tlRFZtTUZKWVoybHROVkpKTkRs
      YVVIYzRVak5EZDJGM1l6QTNUa0V5TjJOSFltWkRlbTF5TWpaR00zazNSemRKZG5ReldUUkpURGhs
      YUhsWmFHUm5SZ3B4YTIwMk5uWkllVWRsTmxnNWVWVmpjblJrUzNOWlFXRjFNWE0wTkhSVU5IQnJh
      MUpUYWl0VlJ6bHBUbGxWVEdzelUyRlNTMU5ZV0cxdFpVRnhiRXRZQ2tOMFV6a3hUVVpYWWtsS00z
      ZHlibTF0VFhKUmRXaDRlVUYwTW14TllWUnFkMDU1VDFoalRuQjFWR0pQWVZoSlRIRkROV1YwZFdn
      elRtZFpkV0ZLVVVFS2NVa3dZV3hNU21obWNsSkpVMlJLTkVNeU5YRk1aa2M0U2tKb1RXMTNRVkUy
      VlhaM2N6VTJZaXRhZDIxWGEyTllaM28xV1ZwWVNHbERaMjF3V0ZNeFJncG9SbE0xVlU1YWNrYzNP
      QzlTVGxGVmFHRTBiMkVyTDNsck5WWm5UVlZsYkVSV1EwaHhSMFk1YVdkWlVtdENiVk5UZFROc1RW
      cFZZbU53Wms5eU5DdE9DbUZxVTJoSGRXaHdhMjlzTTFOSFNVWTFaVVZLYW5CWGFURlJSak52UTFS
      UWVtMXVjM0p1TTNWWlpYTmtObWhCU1RGcFpIVnJVVGg1UW1sbk1EaExiR2NLU1hnNGMwaE9UeXQ0
      TUhWcVJrRlVWalpDV2pCUU9HOUViREpHTjFCSlkwSkxWMnRsWldGM1pGaGFNWEpNVFRVNGVESnJa
      V1J3VG14WldIaG1aems0VEFwRVlrZHJSVUpDVFd4MU1uUjJia2w2V0RsamNqUnVNVXRKZEZsTFpr
      ZGhUbkpUYkZsWVJ6bG5TbG92YUZsTUt6ZHhPRk5TU2tsb1FUSkZkRTF4Y1VndkNteFVWVUpYZDBO
      aVRuSnJjM1pGTWk5WE1VTnRTWHBOVDNsRVZuSTVibkZLTDFVclVYQnFWMU5HY2tWb1JHZEpOazFs
      WWtOblR6SnVXVmxVTnpoM1MwZ0tSVWs1T1doblF5OHJOSGRYZFVkeVFVSmtlbnBLWm14YVpXZHRO
      RTVaSzBOTFNHOXVUa28yYmxKaVYxUlhaMDV5TjFrM2VVcGhiVVZRUTFsd1FYTnlSZ3BpTTJveU1G
      cEhWblp3TkQwS1BUaDBjbkFLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  become: true
  tasks:
    - name: check for update
      shell: \\"{{ ansible_facts['pkg_mgr'] }} check-update -q {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\\\\\\\s*)+') }}\\"
      check_mode: no
      register: check_out
      failed_when: check_out.rc != 0 and check_out.rc != 100

    - when: check_out.rc == 100
      name: upgrade package
      shell: \\"{{ ansible_facts['pkg_mgr'] }} upgrade -v -y {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\\\\\\\s*)+') }}\\"

    - when: check_out.rc == 100
      name: set reboot fact
      set_fact:
        insights_needs_reboot: true

# Reboots a system if any of the preceeding plays sets the 'insights_needs_reboot' variable to true.
# The variable can be overridden to suppress this behavior.
- name: Reboot system (if applicable)
  hosts: \\"84762eb3-0bbb-4bd8-ab11-f420c50e9000.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRMVk0ZG5jMU9FUXJhalZ3VGtGUmFrMUVRa0ZCYTJOeE1W
      WlhVbEF3VUVoMGRIRjBWMGt4UkZSdU4zcE1kbFUyU0hKd2QxSUtUbkJ3Um5SWGJWRktiM2xxYm1w
      bE5XUmFSemMxUTNCU1kzZGFPRU5XVW5sRlRVRXpVREExZW1Kc1UzSnFWbTUxVW5oNlpVeG1SbTFy
      YW1SRVJWcHdjZ3ByWTJ0d2FFazJSVUpIYWtJemEyaGFUalJ5YTNwUWRWQm1PR1pMUVdsSE1ESmxk
      SGhXVFZWV01tZHRkV3c0UjBJMmRIcEpkRk5uVFRGQlFYQkdORTFRQ2s1NFRDOUpUMlY2ZFdRMGFt
      VlFaV05KZWpGS1dtMTVkVGgzWTNoVFZqWkpTbTVPU1VGSGVHYzVWRUpVYzNNMFEwbHVaVlZXY0RG
      VWRrUlFPUzlHVXk4S2VGaFlaMFphWlM5VlZuQjBaRzA1ZDJkbmRVOXRiR2hvWVZCTVZHNU5Tbkoy
      UVRsV2FVUnZRVzV2WWt0b1VIbEtZMHBSYjJOTFdrRlRjVTF6ZWs1VWNncHVNek5JYlRoUk9IQnRW
      VTFLYldobU9VRnZkM2x4VW5GWVVHeHpXVGwzT0UxRU1WQkZjR3htY2pJeVlYTjFMMHhvYjNGNlIz
      TmtOMUUxTTJwdFMyNXBDaXM1Y0VjeWEzVkNSVXhpVVhoblRHcERiVlZsUzFCdmJuaFhjM0JuVFZs
      M2VYQjFaVFJvYnl0dmFsZG5WRGR2ZG1GbFRFNVRTMkV2UkZOS2JEWldRaThLZEd4YUwxUXJPRFZr
      Ym5ZclNWb3phbEJTZFM5bVpuZFBkVVpVV2xoNmVGTkJUalZSV1M5ak15c3hhbUZSTDBKeFdYTmhi
      M2RpUkZreGRXUXZVeXRsYVFwa2FEa3JWRkV5TlVKa1NYa3hibGh3ZWpoV1JHbHpjbEp3Y0VrNWFs
      SldWakkwTVVVelRVWkhka1ZaTm1aVFYzSlZWMWMzY0RKbFpUbGphelpOVlUweUNrNUZjRXBLWm5G
      UFNFdHBjRXRPZVRKdVFVRTJURmcxTHpNeGFWSk9VSEZZVXpKRVdqSlpkbVZTUTJOMmVDOHZPVTlo
      UzFWd1FsZElZVmxYYW5STU4wWUtSWFJWVEZGeFZESkJPVTF3WjFSU1RtOU5WbEZ4Y1haQ01GUlBP
      WE00TmxoTmRuUkdRa1IzYW5SbWIxSm9NRnBEYlUwME1FRlhRMHBxT0RKNlduTlRZUXBCYXpkUEsy
      UkpkMFl5VVQwS1BWcEtiallLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - when:
        - insights_needs_reboot is defined
        - insights_needs_reboot
      block:
        - name: Reboot system
          shell: sleep 2 && shutdown -r now \\"Ansible triggered reboot\\"
          async: 1
          poll: 0
          ignore_errors: true

        - name: Wait for system to boot up
          local_action:
            module: wait_for
            host: \\"{{ hostvars[inventory_hostname]['ansible_host'] | default(hostvars[inventory_hostname]['ansible_ssh_host'], true) | default(inventory_hostname, true) }}\\"
            port: \\"{{ hostvars[inventory_hostname]['ansible_port'] | default(hostvars[inventory_hostname]['ansible_ssh_port'], true) | default('22', true) }}\\"
            delay: 15
            search_regex: OpenSSH
            timeout: 300
          become: false

- name: run insights
  hosts: \\"84762eb3-0bbb-4bd8-ab11-f420c50e9000.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook that does not need reboot 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# Unnamed Playbook
# https://console.redhat.com/insights/remediations/e809526c-56f5-4cd8-a809-93328436ea23
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by tuser@redhat.com

- name: run insights to obtain latest diagnosis info
  hosts: \\"1f12bdfc-8267-492d-a930-92f498fe65b9.ansible.example.com,fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  vars:
    insights_remediation: \\" e809526c-56f5-4cd8-a809-93328436ea23\\"
    insights_signature_exclude: \\"/hosts,/vars/insights_signature,/vars/insights_remediation\\"
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRblZqZG5jMU9FUXJhalZ3VGtGUmFtRkdVa0ZCYTBSVWNu
      UnZRVzFSVkRBdlFVODVaRlJyYlRablJHZHRabUkyVGxGMGFVNEtPWHBNYmtWcmRsaEpibVZQV2s0
      MWRGcDBPSEZWWmtaaFNYQnBSMEV5SzFGWU9GVlNaR2hWTDJOdmRIbDRLMWQ2UlZscU1sSlpaSEEz
      ZEVnM01IQXpWUXBpWjFwbVRGRTNkV2wxYm5NNGIwMXFaV3N5VURaVFVWcExXRmxhV1c0NVYyZENP
      V2R2VG5FMk9FZERXbXR3Um1KVFVqWXJTRVl3TWxwYVVUUlZTV0ZtQ21Ga05XSmplWElyZVVwbFoy
      TlFVVk5RYUhscmNtaGtaV1pQWm5ORk9YUlhlVmhXUjFwSk1ETnNXSGh3VEVaSlJsQlFZWFZRUzNB
      NE5WcHBha0Y0VjNvS2RHYzRTSGRGUjJzME5HRTFRa3BqYVdsdWQyNXJWV1pDVEc0NFVHeHVPRVF2
      TjNSc1NsZExUVWh4TmtsWVkwMW1NVzlVU1RKdWMzZDFXRkZzTUhsbWRRcHNUekYwVHpkWFpHVTJO
      QzlHT0dGdVptNVpUVUZ5TjNoamIxTTJaMU5sTDJWeWRuVnZOamt3YVVOWFYyWm5SV294WVhSd1Qx
      cDJjazF5YmxkSllYUlhDakZrYUVONFVqaGFabkE1UmxsQ2RXUnhZV05yYVhGWVNtNDBjbEppTTFo
      clFVWlNUVmQ0YTBseWJFVkdkRUZKYjJveVdrNDJabGRVYjJwQ1JVTmlRbmNLZG14RmQxWmxObGhR
      ZW5WYWVVRm9Sa0ZFZGxWcU1UZElLME01VnpCd1ZrcHlkM3BSVUV0cE1DOXJlRTFOZVV0UWJ6ZDNa
      R3BEU0dsalFtdHRRVk01TXdwR1ZYbzVUMWcxY0RRNFpIa3lhV1p6TDBOblIyMW5XWFZEWjI1UllW
      QjNWMkpHTUhkMGREQmlWVk55WldkUldWZ3JkV3hJTlhOQlJtMW9TVUZ1Ym1GdENsTkNWVUV5ZFZr
      MVpsZGlPVXhzTmpablIwcGlUSGxNY1ZSUVNFcFNTbWxXWjNKTEt6VnpTMHgyZDNnMmNqTXJjVnBr
      YTFoUVIza3hSM0ZTVlZKT1NGUUtXWFoxVm5sUGRIZHZVV2xCUm1rdlJYWmxPV05xV2xwdWEwcDVW
      MlZUV1RodVVtNDFlbll5TkhSUWJGSkdVVk5xZWtscWMxSlNhVVJvYzA1UWFGUlRhd3AxZGxkYVdI
      SjBWVlpoUlQwS1BVMDNMek1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  become: true
  tasks:
    - name: obtain diagnosis info
      command: \\"insights-client --diagnosis{{ insights_remediation | regex_search('\\\\\\\\s[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}') }}\\"
      register: insights_result
      changed_when: false
      check_mode: false
    - name: register insights report as fact for use by other plays
      set_fact: insights_report={{ insights_result.stdout }}

# Bonding will not fail over to the backup link when bonding options are partially read
# Identifier: (advisor:network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE,fix)
# Version: a0e934f07d8167073546cbc5108c4345f92559a5
- name: Correct Bonding Config Items
  hosts: \\"1f12bdfc-8267-492d-a930-92f498fe65b9.ansible.example.com,fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  become: true
  vars:
    pydata: \\"{{ insights_report.details['network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE'] }}\\"

  tasks:
    - when:
       - pydata.bond_config is defined
      block:
        - name: Add quotes around bonding options
          lineinfile:
            dest: \\"/etc/sysconfig/network-scripts/ifcfg-{{ item.key }}\\"
            regexp: '(^\\\\s*BONDING_OPTS=)(.*)'
            backrefs: yes
            line: '\\\\1\\"\\\\2\\"'
          with_dict: \\"{{ pydata.bond_config }}\\"

        - name: Restart Network Interfaces
          shell: ifdown {{item.key}}  && ifup {{item.key}}
          with_dict: \\"{{ pydata.bond_config }}\\"


- name: run insights
  hosts: \\"1f12bdfc-8267-492d-a930-92f498fe65b9.ansible.example.com,fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook with cert-auth and localhost 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# system profile test
# https://console.redhat.com/insights/remediations/7d727f9c-7d9e-458d-a128-a9ffae1802ab
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Fixes test:reboot
# Identifier: (test:reboot,fix)
# Version: unknown
- name: Trigger reboot
  hosts: \\"localhost\\"
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBSekk0ZG5jMU9FUXJhalZ3VGtGUmFuTkpkeTg1U0hsSlEy
      UTBWRVZPVURobldHbzVSRE5xVVZwVldqSk9iVUk0UVV4NmVrRUtiMFJOYTBkcFZHVXJjWEJTTW1k
      dUszVTVXall2VlRSTlVVcHJMell5TTFOa1pGZzVaRzU0ZHpVd0swaE1hV2xLYUhCQllrdDFPRVpY
      ZEhGc00yWTJiUXBuTkM5UGNuaE1SRWhNV2swMWIxbFZjRE5pUkZkSmJHWTFPRlowV2xNd2N6Wkdi
      R1JSUTBjM2NVMDRXalZUTkZkMGQwcFZLMUZuUlcxc2FDOVNTSFI0Q25CbGFEQkhXVEJuYWs4M2Rq
      Vk1halpSU0hGMVpFUjZkblJzZEhVeE5HdFNVR2RUVkdaMVFUbFpjVVU1WVRKd1ZFMWlZMFJqY1Rk
      UmQzSnlNSGQwUjJRS09UQkJiMVJ5U1dWSWFsWm5SMEU0VjJKbmNUZGhjVTh2TWpadmIyOUVRVGh1
      YjJrek55c3pOMWtyVUVwS01GTTROMmN5T0M5Rk1UZHhWM1JwZW1Obkt3cHlSMVpOYnpWcmJYSjBU
      bVJ2VVhoM1ZTdHpkblpzWjNFMGJsb3hkMHRhT0VoNGRtNW5la3A0VEdGcGFGbzRXakJTUWxJeVNX
      TXJWM2xhYUhJeWFGRTBDa015U25aalduQkVObk56VkdzckswcGpTSHBPUldSeWRFOXVkbVZxU3k5
      b2VIVnZNMXB6Um1SWlptUjBUeloxVUZsU1EwOUJWa3hRWVhOaVNrZFVVR3NLZDJsME1EbHZjblpP
      Tkc4M2NVOVhiRVJFUkhwQmFYWkhia3cyVjFGT09EbDJlRWg1U1ZCQmFsTmxUakJpUjNrM05HWnJT
      VFo2ZVdGNFNtaDJkR3dyVEFwR1kzQm5UWGd5UzBSeFEyRk1abWQzVEd0T2FsaDBaVGhFWkZBeGVD
      ODJiMXBFTnk5dmRtMDVNVEZOTmtOVmVIRnNaa0Z5Vm10UE5sUlhNekJpUVZSeUNtVlplaXQ2TTFa
      a04xVnZNWFpaVFZKaksxbEhTa051ZG1kakwyOXNWR0ZzWW14SVRTdFlVRkpSZG10amNVaERRa0Uz
      T1dNeFJWUk9VbGhDUVVGWmNsTUtTVVZCSzI0MGFFWm9XVTFyU0hsd1JWSnVRV2h0VkVwWGRVbG5h
      MnB6VmpBNWRrZEZjMmxUUlZablVYVjNTVmczYVVkdE0yVlJTMk51WkZSRlEyaFlUQXA2TUd4Sldq
      ZDFhSE5WY3owS1BVTmpjRzBLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: Trigger reboot
      set_fact:
        insights_needs_reboot: true

# Automatic system reboot was suppressed for this playbook.
# This play lists the systems that need to be rebooted manually for the changes to take effect.
- name: Reboot reminder
  hosts: \\"localhost\\"
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRekZ6ZG5jMU9FUXJhalZ3VGtGUmFHaDNkeTh2VVV4SFJE
      aFFNM1l3VlhKWmRFUldabGhaUWxWSFNGQkpUbkpNV1ZCNFFUUUtXWFJXUmtFd1ZXb3diWGhyVVVG
      RFNtbHNZbVJGYVVWdVJIaFVZMVpDZDFSMlpVd3dTVWR0Um5sVVZVWkRVVEZ6WkdRMVUwc3JRMlJy
      TjJKa2RHTmliQW81TlRkaWJtZzVXbk5xYm14dWEwOU5ObTlyVFhVNFNraDZSMDFRV1hST01VaHdR
      VGxJYVV4Mk9IaEdPSFYzTmtkMWQycE9PREJ5ZDNaMmVIZG1WWEpOQ2psWFdYZE1PVU51UzJaRk16
      QnVOM04wTDA1TGJFbDFMMmd3Y2pKU1JTc3hPV1Z0TUdodVJsQmhaa2RwT1RZeWRXaFVTRGhZYzB4
      VWVHOXlRekZhU0c4S09VeENlRU5PVWsxc1draGljVGhzYVd0UVJsaFBhekkxTlNzdmFXMUdkazlE
      V1hwT1RuRXpkVkYxTDB0SWFGTTVhemRaT0Vwb0wyRjZTRFYzYW5KNlV3cDNNekJ1Y25JeVNVOW1j
      V0V2VUdWRlJXOU5SbUV3UVV4WWRFZFVSREpyWmk5Q1pIVXlSemRUU0hkMFNsaG9VbEJzVnpKNU9H
      MW1Za2wwY0UxYWMyTlFDbFp2WkhoVmEwbGtkVXhUTmpaM04wODBPRTVRT1V0Uk9XbE9Wa2hCTVdo
      NVZTOTFWekkwT1ZFd2EwWjZlR3BEUVhsR1QwY3pabkZRUkhWaWNVeFlkbkFLTjB0bFJGWklRbFpS
      UVVkckwwUnhSMFpYT0hoMlVUUkZkSEpVTldrMlVsb3hVRlJMZEZCVmNrVmpRV2hoU2xsWlMwRm9X
      U3R4Y2pkUE1WSkhkazFxUlFwTlEzbFFjVlZ1U0hJMFNHSmtjelJTU0drNVJucFFaeXN2VjB0M2F6
      VnRhMUJMTUUxaEsyMUxkVXd5YTI1elUwaDFTakEzVkVVMk1HNU1WbGM0YTFwakNsSllibGxCU1ZB
      d1RGUnRUMHhvWms0NWJtdzVOM2hvUTNSUFdrZFBjMVp3WVhWdlIyZENOV0ZrV1ZGYVZXY3JSVzF0
      UldSQ1ZrdDZOVUp2VERWc1pYTUtVMjVQVkd3dmFEbG9hekpqYm0xVVdWRTFRa1JoY1RSdGR6QnFS
      SGhDTjFWUWNVdDFZazFDUTJoSVdIUnRVRFpGT1hSU1pYRnNiWHB0YWxkR2QxWnpZd3B1TDBGRFpW
      ZzFZVUUxY3owS1BXZHFZbWdLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - debug:
        msg: \\"Automatic system reboot was suppressed for this playbook. Reboot {{inventory_hostname}} manually for the changes to take effect.\\"
      when:
        - insights_needs_reboot is defined
        - insights_needs_reboot

- name: run insights
  hosts: \\"localhost\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook with cert-auth and no hosts query param 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# system profile test
# https://console.redhat.com/insights/remediations/7d727f9c-7d9e-458d-a128-a9ffae1802ab
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Fixes test:reboot
# Identifier: (test:reboot,fix)
# Version: unknown
- name: Trigger reboot
  hosts: \\"localhost\\"
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBSekk0ZG5jMU9FUXJhalZ3VGtGUmFuTkpkeTg1U0hsSlEy
      UTBWRVZPVURobldHbzVSRE5xVVZwVldqSk9iVUk0UVV4NmVrRUtiMFJOYTBkcFZHVXJjWEJTTW1k
      dUszVTVXall2VlRSTlVVcHJMell5TTFOa1pGZzVaRzU0ZHpVd0swaE1hV2xLYUhCQllrdDFPRVpY
      ZEhGc00yWTJiUXBuTkM5UGNuaE1SRWhNV2swMWIxbFZjRE5pUkZkSmJHWTFPRlowV2xNd2N6Wkdi
      R1JSUTBjM2NVMDRXalZUTkZkMGQwcFZLMUZuUlcxc2FDOVNTSFI0Q25CbGFEQkhXVEJuYWs4M2Rq
      Vk1halpSU0hGMVpFUjZkblJzZEhVeE5HdFNVR2RUVkdaMVFUbFpjVVU1WVRKd1ZFMWlZMFJqY1Rk
      UmQzSnlNSGQwUjJRS09UQkJiMVJ5U1dWSWFsWm5SMEU0VjJKbmNUZGhjVTh2TWpadmIyOUVRVGh1
      YjJrek55c3pOMWtyVUVwS01GTTROMmN5T0M5Rk1UZHhWM1JwZW1Obkt3cHlSMVpOYnpWcmJYSjBU
      bVJ2VVhoM1ZTdHpkblpzWjNFMGJsb3hkMHRhT0VoNGRtNW5la3A0VEdGcGFGbzRXakJTUWxJeVNX
      TXJWM2xhYUhJeWFGRTBDa015U25aalduQkVObk56VkdzckswcGpTSHBPUldSeWRFOXVkbVZxU3k5
      b2VIVnZNMXB6Um1SWlptUjBUeloxVUZsU1EwOUJWa3hRWVhOaVNrZFVVR3NLZDJsME1EbHZjblpP
      Tkc4M2NVOVhiRVJFUkhwQmFYWkhia3cyVjFGT09EbDJlRWg1U1ZCQmFsTmxUakJpUjNrM05HWnJT
      VFo2ZVdGNFNtaDJkR3dyVEFwR1kzQm5UWGd5UzBSeFEyRk1abWQzVEd0T2FsaDBaVGhFWkZBeGVD
      ODJiMXBFTnk5dmRtMDVNVEZOTmtOVmVIRnNaa0Z5Vm10UE5sUlhNekJpUVZSeUNtVlplaXQ2TTFa
      a04xVnZNWFpaVFZKaksxbEhTa051ZG1kakwyOXNWR0ZzWW14SVRTdFlVRkpSZG10amNVaERRa0Uz
      T1dNeFJWUk9VbGhDUVVGWmNsTUtTVVZCSzI0MGFFWm9XVTFyU0hsd1JWSnVRV2h0VkVwWGRVbG5h
      MnB6VmpBNWRrZEZjMmxUUlZablVYVjNTVmczYVVkdE0yVlJTMk51WkZSRlEyaFlUQXA2TUd4Sldq
      ZDFhSE5WY3owS1BVTmpjRzBLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: Trigger reboot
      set_fact:
        insights_needs_reboot: true

# Automatic system reboot was suppressed for this playbook.
# This play lists the systems that need to be rebooted manually for the changes to take effect.
- name: Reboot reminder
  hosts: \\"localhost\\"
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRekZ6ZG5jMU9FUXJhalZ3VGtGUmFHaDNkeTh2VVV4SFJE
      aFFNM1l3VlhKWmRFUldabGhaUWxWSFNGQkpUbkpNV1ZCNFFUUUtXWFJXUmtFd1ZXb3diWGhyVVVG
      RFNtbHNZbVJGYVVWdVJIaFVZMVpDZDFSMlpVd3dTVWR0Um5sVVZVWkRVVEZ6WkdRMVUwc3JRMlJy
      TjJKa2RHTmliQW81TlRkaWJtZzVXbk5xYm14dWEwOU5ObTlyVFhVNFNraDZSMDFRV1hST01VaHdR
      VGxJYVV4Mk9IaEdPSFYzTmtkMWQycE9PREJ5ZDNaMmVIZG1WWEpOQ2psWFdYZE1PVU51UzJaRk16
      QnVOM04wTDA1TGJFbDFMMmd3Y2pKU1JTc3hPV1Z0TUdodVJsQmhaa2RwT1RZeWRXaFVTRGhZYzB4
      VWVHOXlRekZhU0c4S09VeENlRU5PVWsxc1draGljVGhzYVd0UVJsaFBhekkxTlNzdmFXMUdkazlE
      V1hwT1RuRXpkVkYxTDB0SWFGTTVhemRaT0Vwb0wyRjZTRFYzYW5KNlV3cDNNekJ1Y25JeVNVOW1j
      V0V2VUdWRlJXOU5SbUV3UVV4WWRFZFVSREpyWmk5Q1pIVXlSemRUU0hkMFNsaG9VbEJzVnpKNU9H
      MW1Za2wwY0UxYWMyTlFDbFp2WkhoVmEwbGtkVXhUTmpaM04wODBPRTVRT1V0Uk9XbE9Wa2hCTVdo
      NVZTOTFWekkwT1ZFd2EwWjZlR3BEUVhsR1QwY3pabkZRUkhWaWNVeFlkbkFLTjB0bFJGWklRbFpS
      UVVkckwwUnhSMFpYT0hoMlVUUkZkSEpVTldrMlVsb3hVRlJMZEZCVmNrVmpRV2hoU2xsWlMwRm9X
      U3R4Y2pkUE1WSkhkazFxUlFwTlEzbFFjVlZ1U0hJMFNHSmtjelJTU0drNVJucFFaeXN2VjB0M2F6
      VnRhMUJMTUUxaEsyMUxkVXd5YTI1elUwaDFTakEzVkVVMk1HNU1WbGM0YTFwakNsSllibGxCU1ZB
      d1RGUnRUMHhvWms0NWJtdzVOM2hvUTNSUFdrZFBjMVp3WVhWdlIyZENOV0ZrV1ZGYVZXY3JSVzF0
      UldSQ1ZrdDZOVUp2VERWc1pYTUtVMjVQVkd3dmFEbG9hekpqYm0xVVdWRTFRa1JoY1RSdGR6QnFS
      SGhDTjFWUWNVdDFZazFDUTJoSVdIUnRVRFpGT1hSU1pYRnNiWHB0YWxkR2QxWnpZd3B1TDBGRFpW
      ZzFZVUUxY3owS1BXZHFZbWdLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - debug:
        msg: \\"Automatic system reboot was suppressed for this playbook. Reboot {{inventory_hostname}} manually for the changes to take effect.\\"
      when:
        - insights_needs_reboot is defined
        - insights_needs_reboot

- name: run insights
  hosts: \\"localhost\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook with cert-auth enabled 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# system profile test
# https://console.redhat.com/insights/remediations/7d727f9c-7d9e-458d-a128-a9ffae1802ab
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Fixes test:reboot
# Identifier: (test:reboot,fix)
# Version: unknown
- name: Trigger reboot
  hosts: \\"4bb19a8a-0c07-4ee6-a78c-504dab783cc8\\"
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBSekk0ZG5jMU9FUXJhalZ3VGtGUmFuTkpkeTg1U0hsSlEy
      UTBWRVZPVURobldHbzVSRE5xVVZwVldqSk9iVUk0UVV4NmVrRUtiMFJOYTBkcFZHVXJjWEJTTW1k
      dUszVTVXall2VlRSTlVVcHJMell5TTFOa1pGZzVaRzU0ZHpVd0swaE1hV2xLYUhCQllrdDFPRVpY
      ZEhGc00yWTJiUXBuTkM5UGNuaE1SRWhNV2swMWIxbFZjRE5pUkZkSmJHWTFPRlowV2xNd2N6Wkdi
      R1JSUTBjM2NVMDRXalZUTkZkMGQwcFZLMUZuUlcxc2FDOVNTSFI0Q25CbGFEQkhXVEJuYWs4M2Rq
      Vk1halpSU0hGMVpFUjZkblJzZEhVeE5HdFNVR2RUVkdaMVFUbFpjVVU1WVRKd1ZFMWlZMFJqY1Rk
      UmQzSnlNSGQwUjJRS09UQkJiMVJ5U1dWSWFsWm5SMEU0VjJKbmNUZGhjVTh2TWpadmIyOUVRVGh1
      YjJrek55c3pOMWtyVUVwS01GTTROMmN5T0M5Rk1UZHhWM1JwZW1Obkt3cHlSMVpOYnpWcmJYSjBU
      bVJ2VVhoM1ZTdHpkblpzWjNFMGJsb3hkMHRhT0VoNGRtNW5la3A0VEdGcGFGbzRXakJTUWxJeVNX
      TXJWM2xhYUhJeWFGRTBDa015U25aalduQkVObk56VkdzckswcGpTSHBPUldSeWRFOXVkbVZxU3k5
      b2VIVnZNMXB6Um1SWlptUjBUeloxVUZsU1EwOUJWa3hRWVhOaVNrZFVVR3NLZDJsME1EbHZjblpP
      Tkc4M2NVOVhiRVJFUkhwQmFYWkhia3cyVjFGT09EbDJlRWg1U1ZCQmFsTmxUakJpUjNrM05HWnJT
      VFo2ZVdGNFNtaDJkR3dyVEFwR1kzQm5UWGd5UzBSeFEyRk1abWQzVEd0T2FsaDBaVGhFWkZBeGVD
      ODJiMXBFTnk5dmRtMDVNVEZOTmtOVmVIRnNaa0Z5Vm10UE5sUlhNekJpUVZSeUNtVlplaXQ2TTFa
      a04xVnZNWFpaVFZKaksxbEhTa051ZG1kakwyOXNWR0ZzWW14SVRTdFlVRkpSZG10amNVaERRa0Uz
      T1dNeFJWUk9VbGhDUVVGWmNsTUtTVVZCSzI0MGFFWm9XVTFyU0hsd1JWSnVRV2h0VkVwWGRVbG5h
      MnB6VmpBNWRrZEZjMmxUUlZablVYVjNTVmczYVVkdE0yVlJTMk51WkZSRlEyaFlUQXA2TUd4Sldq
      ZDFhSE5WY3owS1BVTmpjRzBLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: Trigger reboot
      set_fact:
        insights_needs_reboot: true

# Automatic system reboot was suppressed for this playbook.
# This play lists the systems that need to be rebooted manually for the changes to take effect.
- name: Reboot reminder
  hosts: \\"4bb19a8a-0c07-4ee6-a78c-504dab783cc8\\"
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRekZ6ZG5jMU9FUXJhalZ3VGtGUmFHaDNkeTh2VVV4SFJE
      aFFNM1l3VlhKWmRFUldabGhaUWxWSFNGQkpUbkpNV1ZCNFFUUUtXWFJXUmtFd1ZXb3diWGhyVVVG
      RFNtbHNZbVJGYVVWdVJIaFVZMVpDZDFSMlpVd3dTVWR0Um5sVVZVWkRVVEZ6WkdRMVUwc3JRMlJy
      TjJKa2RHTmliQW81TlRkaWJtZzVXbk5xYm14dWEwOU5ObTlyVFhVNFNraDZSMDFRV1hST01VaHdR
      VGxJYVV4Mk9IaEdPSFYzTmtkMWQycE9PREJ5ZDNaMmVIZG1WWEpOQ2psWFdYZE1PVU51UzJaRk16
      QnVOM04wTDA1TGJFbDFMMmd3Y2pKU1JTc3hPV1Z0TUdodVJsQmhaa2RwT1RZeWRXaFVTRGhZYzB4
      VWVHOXlRekZhU0c4S09VeENlRU5PVWsxc1draGljVGhzYVd0UVJsaFBhekkxTlNzdmFXMUdkazlE
      V1hwT1RuRXpkVkYxTDB0SWFGTTVhemRaT0Vwb0wyRjZTRFYzYW5KNlV3cDNNekJ1Y25JeVNVOW1j
      V0V2VUdWRlJXOU5SbUV3UVV4WWRFZFVSREpyWmk5Q1pIVXlSemRUU0hkMFNsaG9VbEJzVnpKNU9H
      MW1Za2wwY0UxYWMyTlFDbFp2WkhoVmEwbGtkVXhUTmpaM04wODBPRTVRT1V0Uk9XbE9Wa2hCTVdo
      NVZTOTFWekkwT1ZFd2EwWjZlR3BEUVhsR1QwY3pabkZRUkhWaWNVeFlkbkFLTjB0bFJGWklRbFpS
      UVVkckwwUnhSMFpYT0hoMlVUUkZkSEpVTldrMlVsb3hVRlJMZEZCVmNrVmpRV2hoU2xsWlMwRm9X
      U3R4Y2pkUE1WSkhkazFxUlFwTlEzbFFjVlZ1U0hJMFNHSmtjelJTU0drNVJucFFaeXN2VjB0M2F6
      VnRhMUJMTUUxaEsyMUxkVXd5YTI1elUwaDFTakEzVkVVMk1HNU1WbGM0YTFwakNsSllibGxCU1ZB
      d1RGUnRUMHhvWms0NWJtdzVOM2hvUTNSUFdrZFBjMVp3WVhWdlIyZENOV0ZrV1ZGYVZXY3JSVzF0
      UldSQ1ZrdDZOVUp2VERWc1pYTUtVMjVQVkd3dmFEbG9hekpqYm0xVVdWRTFRa1JoY1RSdGR6QnFS
      SGhDTjFWUWNVdDFZazFDUTJoSVdIUnRVRFpGT1hSU1pYRnNiWHB0YWxkR2QxWnpZd3B1TDBGRFpW
      ZzFZVUUxY3owS1BXZHFZbWdLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - debug:
        msg: \\"Automatic system reboot was suppressed for this playbook. Reboot {{inventory_hostname}} manually for the changes to take effect.\\"
      when:
        - insights_needs_reboot is defined
        - insights_needs_reboot

- name: run insights
  hosts: \\"4bb19a8a-0c07-4ee6-a78c-504dab783cc8\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook with localhost flag 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# test namespace
# https://console.redhat.com/insights/remediations/5e6d136e-ea32-46e4-a350-325ef41790f4
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Fixes test:ping
# Identifier: (test:ping,fix)
# Version: unknown
- name: ping
  hosts: \\"localhost\\"
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlZCZDFWQldVaHBSM0ZqZG5jMU9FUXJhalZ3VGtGUmFrTXpRUzh6VVdwUVow
      MXZTM0JYZFZVeWNuaExWVkpJYTI5VVRHVkdTRmczVDFkVU1Ya0tlRzR6WWtOMU1FeHdXRWhDWjBk
      Vkt6VndTRFF3ZGswdmMzVlhjblJZYjNJckwydHRja3BFWkZWMU5IWkpaMmt4VW1aQmNsTmxabk5H
      TTFCdlIxWnFjUW8yWkhVM1RuQmhOazlQT1cxWFJGWXZPRnBqYW14SVdrVkpUVU5OYlRKamRqQnVk
      RmhuWTJwSmJrTmhlbmtyTVhkNmFHaExUMFJNV1RKTE9WZ3dPVUkzQ2xKR01HMWpjR0ZpUVZsclJH
      ZHpWVVYyU0RCM2RXUTRkRkpuZW5sWVFXWTJZMmw0TTBabVoyOTVTa2d2ZUdFd01uWkZRbFZGUWxG
      dFUzVlhjMEk0ZHpNS2FXaFVVVVpyVEN0NE1uQnliSGxXUWtWd2FqTnlRMmhZY3poMVVsbEJMeTlU
      UjNka1owSndkMlpVWm01ckswUk5VVGRuUzJKbFYyVnhabFFyVlRNNUt3cGFaMGhoTW1WbFkzZFJh
      MmhsVEUwNFkzVkhha012ZFVFNVpWSnhablJRY1RCcU0yVllNWGxGYjNOR1pHTldOekJuYzFJd1dH
      TjBSazlDWTJWSVVXNXRDak4xVjBSVVRqRmllV0kyWVZaYVFqZzVUM1JWTjFCU1preHhSMVkyYjBj
      MU5WQkZVRkV6VVRCSVRXMVRlRWt3WlRjNWNIUXhXVmxHUkhad2FtNXBjSGtLTjJ0aUwzbERObU5s
      ZFZGTWNraHpLMjVSYkVKQ05VSk5OV0ZQVFN0emMwSkpSM1JJZGtWUFRqWTFOMGw2WlRKaGNqRnBj
      bTh5Y1V4TVFXRkJVMHBrVEFwbU9ERmlPSGxFY1hCeVpFOVZaV1ZMYzBncldYazFhekZGVVUwdlRE
      QXpjeTkzVm1wa1NqQktiV2xFVlhwd1pXa3dkVXRCYmxGUWRFdElRbFJsYmtsSENtRnBMMU5KYlRO
      RWMxcHlNRTV4TnpsYVVWVjBiVEpYY0c5bGVrTkZla3ByVlN0eU4weFhjRWg1Y21SdE5VMVpOVzV4
      TW1sb2JsaEVNRFZHTkhsbGIwVUtObmh4VlRGYWJDdERXSEZOYTNOblJUWklZV0l2VDFscVpHRmFX
      VUZwUm5aUlJFOXhPVkU1V1ZVNE5rSnRXSGRwUzNoalltNVRWREJ6VnpZeFVUaFpWd3BWVUVSblpT
      dFJMMHhSUFQwS1BVVnpWVWNLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - ping:

# Fixes test:reboot
# Identifier: (test:reboot,fix)
# Version: unknown
- name: Trigger reboot
  hosts: \\"localhost\\"
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBSekk0ZG5jMU9FUXJhalZ3VGtGUmFuTkpkeTg1U0hsSlEy
      UTBWRVZPVURobldHbzVSRE5xVVZwVldqSk9iVUk0UVV4NmVrRUtiMFJOYTBkcFZHVXJjWEJTTW1k
      dUszVTVXall2VlRSTlVVcHJMell5TTFOa1pGZzVaRzU0ZHpVd0swaE1hV2xLYUhCQllrdDFPRVpY
      ZEhGc00yWTJiUXBuTkM5UGNuaE1SRWhNV2swMWIxbFZjRE5pUkZkSmJHWTFPRlowV2xNd2N6Wkdi
      R1JSUTBjM2NVMDRXalZUTkZkMGQwcFZLMUZuUlcxc2FDOVNTSFI0Q25CbGFEQkhXVEJuYWs4M2Rq
      Vk1halpSU0hGMVpFUjZkblJzZEhVeE5HdFNVR2RUVkdaMVFUbFpjVVU1WVRKd1ZFMWlZMFJqY1Rk
      UmQzSnlNSGQwUjJRS09UQkJiMVJ5U1dWSWFsWm5SMEU0VjJKbmNUZGhjVTh2TWpadmIyOUVRVGh1
      YjJrek55c3pOMWtyVUVwS01GTTROMmN5T0M5Rk1UZHhWM1JwZW1Obkt3cHlSMVpOYnpWcmJYSjBU
      bVJ2VVhoM1ZTdHpkblpzWjNFMGJsb3hkMHRhT0VoNGRtNW5la3A0VEdGcGFGbzRXakJTUWxJeVNX
      TXJWM2xhYUhJeWFGRTBDa015U25aalduQkVObk56VkdzckswcGpTSHBPUldSeWRFOXVkbVZxU3k5
      b2VIVnZNMXB6Um1SWlptUjBUeloxVUZsU1EwOUJWa3hRWVhOaVNrZFVVR3NLZDJsME1EbHZjblpP
      Tkc4M2NVOVhiRVJFUkhwQmFYWkhia3cyVjFGT09EbDJlRWg1U1ZCQmFsTmxUakJpUjNrM05HWnJT
      VFo2ZVdGNFNtaDJkR3dyVEFwR1kzQm5UWGd5UzBSeFEyRk1abWQzVEd0T2FsaDBaVGhFWkZBeGVD
      ODJiMXBFTnk5dmRtMDVNVEZOTmtOVmVIRnNaa0Z5Vm10UE5sUlhNekJpUVZSeUNtVlplaXQ2TTFa
      a04xVnZNWFpaVFZKaksxbEhTa051ZG1kakwyOXNWR0ZzWW14SVRTdFlVRkpSZG10amNVaERRa0Uz
      T1dNeFJWUk9VbGhDUVVGWmNsTUtTVVZCSzI0MGFFWm9XVTFyU0hsd1JWSnVRV2h0VkVwWGRVbG5h
      MnB6VmpBNWRrZEZjMmxUUlZablVYVjNTVmczYVVkdE0yVlJTMk51WkZSRlEyaFlUQXA2TUd4Sldq
      ZDFhSE5WY3owS1BVTmpjRzBLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: Trigger reboot
      set_fact:
        insights_needs_reboot: true

# Automatic system reboot was suppressed for this playbook.
# This play lists the systems that need to be rebooted manually for the changes to take effect.
- name: Reboot reminder
  hosts: \\"localhost\\"
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRekZ6ZG5jMU9FUXJhalZ3VGtGUmFHaDNkeTh2VVV4SFJE
      aFFNM1l3VlhKWmRFUldabGhaUWxWSFNGQkpUbkpNV1ZCNFFUUUtXWFJXUmtFd1ZXb3diWGhyVVVG
      RFNtbHNZbVJGYVVWdVJIaFVZMVpDZDFSMlpVd3dTVWR0Um5sVVZVWkRVVEZ6WkdRMVUwc3JRMlJy
      TjJKa2RHTmliQW81TlRkaWJtZzVXbk5xYm14dWEwOU5ObTlyVFhVNFNraDZSMDFRV1hST01VaHdR
      VGxJYVV4Mk9IaEdPSFYzTmtkMWQycE9PREJ5ZDNaMmVIZG1WWEpOQ2psWFdYZE1PVU51UzJaRk16
      QnVOM04wTDA1TGJFbDFMMmd3Y2pKU1JTc3hPV1Z0TUdodVJsQmhaa2RwT1RZeWRXaFVTRGhZYzB4
      VWVHOXlRekZhU0c4S09VeENlRU5PVWsxc1draGljVGhzYVd0UVJsaFBhekkxTlNzdmFXMUdkazlE
      V1hwT1RuRXpkVkYxTDB0SWFGTTVhemRaT0Vwb0wyRjZTRFYzYW5KNlV3cDNNekJ1Y25JeVNVOW1j
      V0V2VUdWRlJXOU5SbUV3UVV4WWRFZFVSREpyWmk5Q1pIVXlSemRUU0hkMFNsaG9VbEJzVnpKNU9H
      MW1Za2wwY0UxYWMyTlFDbFp2WkhoVmEwbGtkVXhUTmpaM04wODBPRTVRT1V0Uk9XbE9Wa2hCTVdo
      NVZTOTFWekkwT1ZFd2EwWjZlR3BEUVhsR1QwY3pabkZRUkhWaWNVeFlkbkFLTjB0bFJGWklRbFpS
      UVVkckwwUnhSMFpYT0hoMlVUUkZkSEpVTldrMlVsb3hVRlJMZEZCVmNrVmpRV2hoU2xsWlMwRm9X
      U3R4Y2pkUE1WSkhkazFxUlFwTlEzbFFjVlZ1U0hJMFNHSmtjelJTU0drNVJucFFaeXN2VjB0M2F6
      VnRhMUJMTUUxaEsyMUxkVXd5YTI1elUwaDFTakEzVkVVMk1HNU1WbGM0YTFwakNsSllibGxCU1ZB
      d1RGUnRUMHhvWms0NWJtdzVOM2hvUTNSUFdrZFBjMVp3WVhWdlIyZENOV0ZrV1ZGYVZXY3JSVzF0
      UldSQ1ZrdDZOVUp2VERWc1pYTUtVMjVQVkd3dmFEbG9hekpqYm0xVVdWRTFRa1JoY1RSdGR6QnFS
      SGhDTjFWUWNVdDFZazFDUTJoSVdIUnRVRFpGT1hSU1pYRnNiWHB0YWxkR2QxWnpZd3B1TDBGRFpW
      ZzFZVUUxY3owS1BXZHFZbWdLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - debug:
        msg: \\"Automatic system reboot was suppressed for this playbook. Reboot {{inventory_hostname}} manually for the changes to take effect.\\"
      when:
        - insights_needs_reboot is defined
        - insights_needs_reboot

- name: run insights
  hosts: \\"localhost\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook with localhost flag and reboot 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# many systems
# https://console.redhat.com/insights/remediations/c3f9f751-4bcc-4222-9b83-77f5e6e603da
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Upgrade packages affected by CVE-2017-5715
# Identifier: (vulnerabilities:CVE-2017-5715,fix)
# Version: test
- name: update vulnerable packages
  hosts: \\"localhost\\"
  vars:
    insights_issues: \\"--cve CVE-2017-5715\\"
    insights_signature_exclude: /hosts,/vars/insights_signature,/vars/insights_issues
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldWTmFUMGM0ZG5jMU9FUXJhalZ3VGtGUmFFVnpRUzh2VW1OSFFU
      TjFLM2RDVFdOYWJTOTNheTlOVVVKRGVua3pRWEZsZG1Jd1NIa0tlRFZtTUZKWVoybHROVkpKTkRs
      YVVIYzRVak5EZDJGM1l6QTNUa0V5TjJOSFltWkRlbTF5TWpaR00zazNSemRKZG5ReldUUkpURGhs
      YUhsWmFHUm5SZ3B4YTIwMk5uWkllVWRsTmxnNWVWVmpjblJrUzNOWlFXRjFNWE0wTkhSVU5IQnJh
      MUpUYWl0VlJ6bHBUbGxWVEdzelUyRlNTMU5ZV0cxdFpVRnhiRXRZQ2tOMFV6a3hUVVpYWWtsS00z
      ZHlibTF0VFhKUmRXaDRlVUYwTW14TllWUnFkMDU1VDFoalRuQjFWR0pQWVZoSlRIRkROV1YwZFdn
      elRtZFpkV0ZLVVVFS2NVa3dZV3hNU21obWNsSkpVMlJLTkVNeU5YRk1aa2M0U2tKb1RXMTNRVkUy
      VlhaM2N6VTJZaXRhZDIxWGEyTllaM28xV1ZwWVNHbERaMjF3V0ZNeFJncG9SbE0xVlU1YWNrYzNP
      QzlTVGxGVmFHRTBiMkVyTDNsck5WWm5UVlZsYkVSV1EwaHhSMFk1YVdkWlVtdENiVk5UZFROc1RW
      cFZZbU53Wms5eU5DdE9DbUZxVTJoSGRXaHdhMjlzTTFOSFNVWTFaVVZLYW5CWGFURlJSak52UTFS
      UWVtMXVjM0p1TTNWWlpYTmtObWhCU1RGcFpIVnJVVGg1UW1sbk1EaExiR2NLU1hnNGMwaE9UeXQ0
      TUhWcVJrRlVWalpDV2pCUU9HOUViREpHTjFCSlkwSkxWMnRsWldGM1pGaGFNWEpNVFRVNGVESnJa
      V1J3VG14WldIaG1aems0VEFwRVlrZHJSVUpDVFd4MU1uUjJia2w2V0RsamNqUnVNVXRKZEZsTFpr
      ZGhUbkpUYkZsWVJ6bG5TbG92YUZsTUt6ZHhPRk5TU2tsb1FUSkZkRTF4Y1VndkNteFVWVUpYZDBO
      aVRuSnJjM1pGTWk5WE1VTnRTWHBOVDNsRVZuSTVibkZLTDFVclVYQnFWMU5HY2tWb1JHZEpOazFs
      WWtOblR6SnVXVmxVTnpoM1MwZ0tSVWs1T1doblF5OHJOSGRYZFVkeVFVSmtlbnBLWm14YVpXZHRO
      RTVaSzBOTFNHOXVUa28yYmxKaVYxUlhaMDV5TjFrM2VVcGhiVVZRUTFsd1FYTnlSZ3BpTTJveU1G
      cEhWblp3TkQwS1BUaDBjbkFLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  become: true
  tasks:
    - name: check for update
      shell: \\"{{ ansible_facts['pkg_mgr'] }} check-update -q {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\\\\\\\s*)+') }}\\"
      check_mode: no
      register: check_out
      failed_when: check_out.rc != 0 and check_out.rc != 100

    - when: check_out.rc == 100
      name: upgrade package
      shell: \\"{{ ansible_facts['pkg_mgr'] }} upgrade -v -y {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\\\\\\\s*)+') }}\\"

    - when: check_out.rc == 100
      name: set reboot fact
      set_fact:
        insights_needs_reboot: true

# Reboots a system if any of the preceeding plays sets the 'insights_needs_reboot' variable to true.
# The variable can be overridden to suppress this behavior.
- name: Reboot localhost
  hosts: \\"localhost\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVdEtObkE0ZG5jMU9FUXJhalZ3VGtGUmFGZFJRUzh2WTB0MFIz
      UXlVME5ZWmpOQ2NHYzJaRzVoUkVSTU1XOTBWalpMVm1zdmNWTUtUMkZhVDBSMkwwcE1WMFZETlRa
      cmEwcDFUSEYwYkVaUU9YQjBVRFIxU3pkd2VEUnJaVW95U2tnMVdVOHhjVUp3YkU1M1ZXUmhjMmt5
      TVdveVJVaENUQXBzVVZoVk1FRTRSVmRqUW1NMmVHUjRZMnRCUW0xRVR6YzNkM2RPY1ZsRU0wbERT
      MlJxYkUxVlpqa3JibUZYTkZkWE5VcGpVME14VmtOWmFVaHRjRGxEQ2xab2NITmtXRVV6VVV0Q1VU
      WjFNM1JQUm0xTlptbEtZbTF1TUZsUGFHVkxjbmROVVZsTmRsSXlhelJNUzJwRlprZDZaVWhVZUVs
      YVJ6RTFNMDFySzBnS2FFMW9VbVpXSzNvNWRYQkJSMkZTVmxNeVN6TTRORlpKTUVaaFVYUm9WRlpW
      YUdsTGJ6SnJlRE15WTBwdE5WaG5iSEZKU1dZd1ZFeHBXak5rUld4c1ZRcEpVMWRoZEVwblRWUjJP
      VE5MUlZkNFRUbFVSMUJ6VkZRek1VbDFUR2h4UWpRMlozbFVkWEJwZVRJclRGVnJWVzFrS3pNMlMz
      azFjbGxWU25OTlVXaFdDbTFxUXpjdlZqVnRaVTVGTDI0eGNGWndOeTlLUmxJMGJtSXZWRkl2V2tv
      eWFYcE1aMWt5ZEhGUlJUazJkVFpLUVVSbGFWVTNXRWRGVkc5MlYwWlZRMVlLV0hSbFdVUnFjRUpQ
      Y0ZOQlYyNXlhMlZqZGpJNWIzTmFkVEowVFVsMldrRXJla3BRVERZek4yODJVMlFyTlhsWWIzWnNV
      bWR3UlZSQ09HbGtWMFZ3Y2dwVWNVVkNNblpsUkdZd1oyUkxiRkZVYzJRMWNWTk5VV1pqVVhFemFH
      ZExWRzVrZEZsaFNUTXJaMGN2TnpKRGEwbG1jVWhQUlhKTFNUTkVTbkkyWlRGSENqSk5iRlJwU2tw
      QlNVNU9Vemx3WkVNM1lXWXlLMWMyTlRsUVdWRTRNRTFESzFJMFIyaE9ZVFpaZWpGalZVTllVbHAz
      UVM5UlNFSk9jRTlxWWxkbGVuUUtNalE0SzJwcmNIQk1PUzg0Y2pSVVpVUk9TUzlOZEZSTU9UbFNW
      SGd6YTI5SlIzcEtXVmxpV25vMldUWk1UQ3RZWjFsVFZEaFVWV2RsY2tSWVZucFBjZ281WlU0MUsz
      TXhVV1pIYXowS1BXazFRa3dLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - when:
        - insights_needs_reboot is defined
        - insights_needs_reboot
      block:
        - name: Schedule insights-client after boot
          file:
            path: \\"/etc/insights-client/.run_insights_client_next_boot\\"
            state: touch
        - name: Enable boot service
          systemd:
            name: insights-client-boot.service
            enabled: true
          ignore_errors: true
        - name: Reboot system
          shell: sleep 2 && shutdown -r +1 now \\"Ansible triggered reboot\\"
          ignore_errors: true"
`;

exports[`playbooks generate playbook with many hosts 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# many systems
# https://console.redhat.com/insights/remediations/c3f9f751-4bcc-4222-9b83-77f5e6e603da
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Upgrade packages affected by CVE-2017-5715
# Identifier: (vulnerabilities:CVE-2017-5715,fix)
# Version: test
- name: update vulnerable packages
  hosts: \\"84762eb3-0bbb-4bd8-ab11-f420c50e9000.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9001.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9002.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9003.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9004.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9005.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9006.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9007.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9008.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9009.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9010.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9011.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9012.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9013.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9014.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9015.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9016.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9017.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9018.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9019.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9020.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9021.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9022.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9023.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9024.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9025.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9026.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9027.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9028.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9029.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9030.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9031.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9032.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9033.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9034.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9035.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9036.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9037.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9038.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9039.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9040.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9041.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9042.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9043.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9044.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9045.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9046.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9047.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9048.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9049.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9050.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9051.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9052.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9053.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9054.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9055.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9056.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9057.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9058.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9059.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9060.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9061.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9062.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9063.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9064.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9065.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9066.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9067.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9068.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9069.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9070.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9071.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9072.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9073.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9074.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9075.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9076.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9077.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9078.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9079.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9080.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9081.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9082.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9083.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9084.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9085.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9086.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9087.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9088.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9089.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9090.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9091.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9092.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9093.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9094.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9095.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9096.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9097.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9098.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9099.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9100.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9101.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9102.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9103.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9104.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9105.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9106.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9107.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9108.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9109.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9110.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9111.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9112.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9113.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9114.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9115.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9116.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9117.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9118.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9119.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9120.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9121.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9122.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9123.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9124.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9125.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9126.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9127.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9128.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9129.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9130.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9131.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9132.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9133.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9134.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9135.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9136.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9137.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9138.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9139.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9140.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9141.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9142.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9143.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9144.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9145.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9146.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9147.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9148.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9149.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9150.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9151.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9152.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9153.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9154.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9155.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9156.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9157.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9158.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9159.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9160.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9161.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9162.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9163.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9164.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9165.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9166.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9167.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9168.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9169.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9170.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9171.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9172.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9173.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9174.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9175.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9176.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9177.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9178.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9179.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9180.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9181.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9182.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9183.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9184.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9185.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9186.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9187.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9188.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9189.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9190.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9191.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9192.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9193.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9194.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9195.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9196.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9197.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9198.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9199.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9200.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9201.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9202.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9203.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9204.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9205.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9206.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9207.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9208.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9209.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9210.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9211.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9212.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9213.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9214.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9215.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9216.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9217.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9218.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9219.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9220.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9221.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9222.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9223.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9224.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9225.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9226.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9227.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9228.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9229.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9230.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9231.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9232.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9233.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9234.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9235.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9236.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9237.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9238.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9239.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9240.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9241.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9242.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9243.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9244.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9245.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9246.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9247.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9248.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9249.example.com\\"
  vars:
    insights_issues: \\"--cve CVE-2017-5715\\"
    insights_signature_exclude: /hosts,/vars/insights_signature,/vars/insights_issues
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldWTmFUMGM0ZG5jMU9FUXJhalZ3VGtGUmFFVnpRUzh2VW1OSFFU
      TjFLM2RDVFdOYWJTOTNheTlOVVVKRGVua3pRWEZsZG1Jd1NIa0tlRFZtTUZKWVoybHROVkpKTkRs
      YVVIYzRVak5EZDJGM1l6QTNUa0V5TjJOSFltWkRlbTF5TWpaR00zazNSemRKZG5ReldUUkpURGhs
      YUhsWmFHUm5SZ3B4YTIwMk5uWkllVWRsTmxnNWVWVmpjblJrUzNOWlFXRjFNWE0wTkhSVU5IQnJh
      MUpUYWl0VlJ6bHBUbGxWVEdzelUyRlNTMU5ZV0cxdFpVRnhiRXRZQ2tOMFV6a3hUVVpYWWtsS00z
      ZHlibTF0VFhKUmRXaDRlVUYwTW14TllWUnFkMDU1VDFoalRuQjFWR0pQWVZoSlRIRkROV1YwZFdn
      elRtZFpkV0ZLVVVFS2NVa3dZV3hNU21obWNsSkpVMlJLTkVNeU5YRk1aa2M0U2tKb1RXMTNRVkUy
      VlhaM2N6VTJZaXRhZDIxWGEyTllaM28xV1ZwWVNHbERaMjF3V0ZNeFJncG9SbE0xVlU1YWNrYzNP
      QzlTVGxGVmFHRTBiMkVyTDNsck5WWm5UVlZsYkVSV1EwaHhSMFk1YVdkWlVtdENiVk5UZFROc1RW
      cFZZbU53Wms5eU5DdE9DbUZxVTJoSGRXaHdhMjlzTTFOSFNVWTFaVVZLYW5CWGFURlJSak52UTFS
      UWVtMXVjM0p1TTNWWlpYTmtObWhCU1RGcFpIVnJVVGg1UW1sbk1EaExiR2NLU1hnNGMwaE9UeXQ0
      TUhWcVJrRlVWalpDV2pCUU9HOUViREpHTjFCSlkwSkxWMnRsWldGM1pGaGFNWEpNVFRVNGVESnJa
      V1J3VG14WldIaG1aems0VEFwRVlrZHJSVUpDVFd4MU1uUjJia2w2V0RsamNqUnVNVXRKZEZsTFpr
      ZGhUbkpUYkZsWVJ6bG5TbG92YUZsTUt6ZHhPRk5TU2tsb1FUSkZkRTF4Y1VndkNteFVWVUpYZDBO
      aVRuSnJjM1pGTWk5WE1VTnRTWHBOVDNsRVZuSTVibkZLTDFVclVYQnFWMU5HY2tWb1JHZEpOazFs
      WWtOblR6SnVXVmxVTnpoM1MwZ0tSVWs1T1doblF5OHJOSGRYZFVkeVFVSmtlbnBLWm14YVpXZHRO
      RTVaSzBOTFNHOXVUa28yYmxKaVYxUlhaMDV5TjFrM2VVcGhiVVZRUTFsd1FYTnlSZ3BpTTJveU1G
      cEhWblp3TkQwS1BUaDBjbkFLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  become: true
  tasks:
    - name: check for update
      shell: \\"{{ ansible_facts['pkg_mgr'] }} check-update -q {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\\\\\\\s*)+') }}\\"
      check_mode: no
      register: check_out
      failed_when: check_out.rc != 0 and check_out.rc != 100

    - when: check_out.rc == 100
      name: upgrade package
      shell: \\"{{ ansible_facts['pkg_mgr'] }} upgrade -v -y {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\\\\\\\s*)+') }}\\"

    - when: check_out.rc == 100
      name: set reboot fact
      set_fact:
        insights_needs_reboot: true

# Reboots a system if any of the preceeding plays sets the 'insights_needs_reboot' variable to true.
# The variable can be overridden to suppress this behavior.
- name: Reboot system (if applicable)
  hosts: \\"84762eb3-0bbb-4bd8-ab11-f420c50e9000.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9001.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9002.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9003.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9004.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9005.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9006.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9007.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9008.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9009.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9010.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9011.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9012.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9013.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9014.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9015.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9016.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9017.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9018.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9019.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9020.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9021.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9022.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9023.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9024.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9025.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9026.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9027.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9028.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9029.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9030.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9031.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9032.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9033.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9034.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9035.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9036.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9037.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9038.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9039.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9040.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9041.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9042.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9043.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9044.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9045.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9046.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9047.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9048.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9049.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9050.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9051.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9052.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9053.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9054.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9055.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9056.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9057.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9058.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9059.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9060.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9061.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9062.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9063.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9064.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9065.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9066.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9067.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9068.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9069.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9070.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9071.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9072.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9073.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9074.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9075.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9076.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9077.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9078.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9079.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9080.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9081.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9082.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9083.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9084.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9085.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9086.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9087.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9088.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9089.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9090.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9091.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9092.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9093.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9094.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9095.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9096.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9097.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9098.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9099.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9100.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9101.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9102.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9103.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9104.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9105.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9106.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9107.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9108.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9109.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9110.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9111.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9112.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9113.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9114.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9115.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9116.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9117.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9118.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9119.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9120.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9121.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9122.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9123.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9124.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9125.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9126.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9127.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9128.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9129.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9130.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9131.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9132.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9133.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9134.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9135.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9136.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9137.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9138.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9139.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9140.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9141.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9142.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9143.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9144.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9145.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9146.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9147.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9148.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9149.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9150.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9151.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9152.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9153.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9154.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9155.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9156.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9157.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9158.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9159.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9160.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9161.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9162.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9163.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9164.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9165.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9166.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9167.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9168.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9169.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9170.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9171.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9172.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9173.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9174.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9175.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9176.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9177.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9178.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9179.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9180.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9181.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9182.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9183.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9184.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9185.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9186.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9187.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9188.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9189.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9190.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9191.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9192.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9193.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9194.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9195.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9196.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9197.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9198.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9199.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9200.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9201.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9202.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9203.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9204.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9205.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9206.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9207.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9208.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9209.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9210.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9211.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9212.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9213.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9214.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9215.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9216.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9217.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9218.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9219.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9220.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9221.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9222.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9223.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9224.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9225.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9226.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9227.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9228.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9229.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9230.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9231.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9232.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9233.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9234.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9235.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9236.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9237.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9238.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9239.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9240.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9241.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9242.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9243.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9244.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9245.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9246.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9247.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9248.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9249.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRMVk0ZG5jMU9FUXJhalZ3VGtGUmFrMUVRa0ZCYTJOeE1W
      WlhVbEF3VUVoMGRIRjBWMGt4UkZSdU4zcE1kbFUyU0hKd2QxSUtUbkJ3Um5SWGJWRktiM2xxYm1w
      bE5XUmFSemMxUTNCU1kzZGFPRU5XVW5sRlRVRXpVREExZW1Kc1UzSnFWbTUxVW5oNlpVeG1SbTFy
      YW1SRVJWcHdjZ3ByWTJ0d2FFazJSVUpIYWtJemEyaGFUalJ5YTNwUWRWQm1PR1pMUVdsSE1ESmxk
      SGhXVFZWV01tZHRkV3c0UjBJMmRIcEpkRk5uVFRGQlFYQkdORTFRQ2s1NFRDOUpUMlY2ZFdRMGFt
      VlFaV05KZWpGS1dtMTVkVGgzWTNoVFZqWkpTbTVPU1VGSGVHYzVWRUpVYzNNMFEwbHVaVlZXY0RG
      VWRrUlFPUzlHVXk4S2VGaFlaMFphWlM5VlZuQjBaRzA1ZDJkbmRVOXRiR2hvWVZCTVZHNU5Tbkoy
      UVRsV2FVUnZRVzV2WWt0b1VIbEtZMHBSYjJOTFdrRlRjVTF6ZWs1VWNncHVNek5JYlRoUk9IQnRW
      VTFLYldobU9VRnZkM2x4VW5GWVVHeHpXVGwzT0UxRU1WQkZjR3htY2pJeVlYTjFMMHhvYjNGNlIz
      TmtOMUUxTTJwdFMyNXBDaXM1Y0VjeWEzVkNSVXhpVVhoblRHcERiVlZsUzFCdmJuaFhjM0JuVFZs
      M2VYQjFaVFJvYnl0dmFsZG5WRGR2ZG1GbFRFNVRTMkV2UkZOS2JEWldRaThLZEd4YUwxUXJPRFZr
      Ym5ZclNWb3phbEJTZFM5bVpuZFBkVVpVV2xoNmVGTkJUalZSV1M5ak15c3hhbUZSTDBKeFdYTmhi
      M2RpUkZreGRXUXZVeXRsYVFwa2FEa3JWRkV5TlVKa1NYa3hibGh3ZWpoV1JHbHpjbEp3Y0VrNWFs
      SldWakkwTVVVelRVWkhka1ZaTm1aVFYzSlZWMWMzY0RKbFpUbGphelpOVlUweUNrNUZjRXBLWm5G
      UFNFdHBjRXRPZVRKdVFVRTJURmcxTHpNeGFWSk9VSEZZVXpKRVdqSlpkbVZTUTJOMmVDOHZPVTlo
      UzFWd1FsZElZVmxYYW5STU4wWUtSWFJWVEZGeFZESkJPVTF3WjFSU1RtOU5WbEZ4Y1haQ01GUlBP
      WE00TmxoTmRuUkdRa1IzYW5SbWIxSm9NRnBEYlUwME1FRlhRMHBxT0RKNlduTlRZUXBCYXpkUEsy
      UkpkMFl5VVQwS1BWcEtiallLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - when:
        - insights_needs_reboot is defined
        - insights_needs_reboot
      block:
        - name: Reboot system
          shell: sleep 2 && shutdown -r now \\"Ansible triggered reboot\\"
          async: 1
          poll: 0
          ignore_errors: true

        - name: Wait for system to boot up
          local_action:
            module: wait_for
            host: \\"{{ hostvars[inventory_hostname]['ansible_host'] | default(hostvars[inventory_hostname]['ansible_ssh_host'], true) | default(inventory_hostname, true) }}\\"
            port: \\"{{ hostvars[inventory_hostname]['ansible_port'] | default(hostvars[inventory_hostname]['ansible_ssh_port'], true) | default('22', true) }}\\"
            delay: 15
            search_regex: OpenSSH
            timeout: 300
          become: false

- name: run insights
  hosts: \\"84762eb3-0bbb-4bd8-ab11-f420c50e9000.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9001.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9002.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9003.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9004.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9005.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9006.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9007.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9008.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9009.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9010.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9011.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9012.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9013.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9014.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9015.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9016.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9017.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9018.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9019.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9020.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9021.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9022.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9023.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9024.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9025.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9026.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9027.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9028.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9029.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9030.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9031.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9032.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9033.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9034.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9035.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9036.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9037.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9038.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9039.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9040.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9041.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9042.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9043.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9044.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9045.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9046.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9047.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9048.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9049.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9050.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9051.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9052.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9053.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9054.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9055.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9056.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9057.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9058.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9059.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9060.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9061.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9062.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9063.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9064.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9065.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9066.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9067.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9068.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9069.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9070.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9071.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9072.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9073.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9074.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9075.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9076.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9077.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9078.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9079.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9080.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9081.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9082.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9083.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9084.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9085.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9086.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9087.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9088.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9089.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9090.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9091.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9092.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9093.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9094.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9095.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9096.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9097.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9098.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9099.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9100.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9101.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9102.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9103.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9104.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9105.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9106.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9107.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9108.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9109.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9110.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9111.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9112.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9113.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9114.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9115.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9116.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9117.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9118.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9119.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9120.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9121.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9122.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9123.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9124.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9125.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9126.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9127.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9128.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9129.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9130.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9131.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9132.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9133.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9134.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9135.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9136.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9137.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9138.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9139.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9140.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9141.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9142.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9143.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9144.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9145.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9146.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9147.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9148.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9149.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9150.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9151.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9152.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9153.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9154.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9155.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9156.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9157.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9158.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9159.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9160.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9161.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9162.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9163.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9164.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9165.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9166.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9167.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9168.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9169.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9170.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9171.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9172.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9173.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9174.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9175.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9176.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9177.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9178.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9179.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9180.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9181.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9182.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9183.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9184.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9185.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9186.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9187.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9188.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9189.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9190.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9191.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9192.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9193.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9194.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9195.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9196.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9197.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9198.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9199.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9200.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9201.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9202.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9203.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9204.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9205.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9206.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9207.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9208.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9209.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9210.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9211.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9212.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9213.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9214.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9215.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9216.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9217.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9218.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9219.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9220.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9221.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9222.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9223.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9224.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9225.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9226.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9227.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9228.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9229.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9230.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9231.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9232.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9233.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9234.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9235.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9236.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9237.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9238.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9239.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9240.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9241.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9242.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9243.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9244.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9245.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9246.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9247.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9248.example.com,84762eb3-0bbb-4bd8-ab11-f420c50e9249.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook with pydata and playbook support 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# remediation 1
# https://console.redhat.com/insights/remediations/66eec356-dd06-4c72-a3b6-ef27d1508a02
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by tuser@redhat.com

- name: run insights to obtain latest diagnosis info
  hosts: \\"fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  vars:
    insights_remediation: \\" 66eec356-dd06-4c72-a3b6-ef27d1508a02\\"
    insights_signature_exclude: \\"/hosts,/vars/insights_signature,/vars/insights_remediation\\"
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRblZqZG5jMU9FUXJhalZ3VGtGUmFtRkdVa0ZCYTBSVWNu
      UnZRVzFSVkRBdlFVODVaRlJyYlRablJHZHRabUkyVGxGMGFVNEtPWHBNYmtWcmRsaEpibVZQV2s0
      MWRGcDBPSEZWWmtaaFNYQnBSMEV5SzFGWU9GVlNaR2hWTDJOdmRIbDRLMWQ2UlZscU1sSlpaSEEz
      ZEVnM01IQXpWUXBpWjFwbVRGRTNkV2wxYm5NNGIwMXFaV3N5VURaVFVWcExXRmxhV1c0NVYyZENP
      V2R2VG5FMk9FZERXbXR3Um1KVFVqWXJTRVl3TWxwYVVUUlZTV0ZtQ21Ga05XSmplWElyZVVwbFoy
      TlFVVk5RYUhscmNtaGtaV1pQWm5ORk9YUlhlVmhXUjFwSk1ETnNXSGh3VEVaSlJsQlFZWFZRUzNB
      NE5WcHBha0Y0VjNvS2RHYzRTSGRGUjJzME5HRTFRa3BqYVdsdWQyNXJWV1pDVEc0NFVHeHVPRVF2
      TjNSc1NsZExUVWh4TmtsWVkwMW1NVzlVU1RKdWMzZDFXRkZzTUhsbWRRcHNUekYwVHpkWFpHVTJO
      QzlHT0dGdVptNVpUVUZ5TjNoamIxTTJaMU5sTDJWeWRuVnZOamt3YVVOWFYyWm5SV294WVhSd1Qx
      cDJjazF5YmxkSllYUlhDakZrYUVONFVqaGFabkE1UmxsQ2RXUnhZV05yYVhGWVNtNDBjbEppTTFo
      clFVWlNUVmQ0YTBseWJFVkdkRUZKYjJveVdrNDJabGRVYjJwQ1JVTmlRbmNLZG14RmQxWmxObGhR
      ZW5WYWVVRm9Sa0ZFZGxWcU1UZElLME01VnpCd1ZrcHlkM3BSVUV0cE1DOXJlRTFOZVV0UWJ6ZDNa
      R3BEU0dsalFtdHRRVk01TXdwR1ZYbzVUMWcxY0RRNFpIa3lhV1p6TDBOblIyMW5XWFZEWjI1UllW
      QjNWMkpHTUhkMGREQmlWVk55WldkUldWZ3JkV3hJTlhOQlJtMW9TVUZ1Ym1GdENsTkNWVUV5ZFZr
      MVpsZGlPVXhzTmpablIwcGlUSGxNY1ZSUVNFcFNTbWxXWjNKTEt6VnpTMHgyZDNnMmNqTXJjVnBr
      YTFoUVIza3hSM0ZTVlZKT1NGUUtXWFoxVm5sUGRIZHZVV2xCUm1rdlJYWmxPV05xV2xwdWEwcDVW
      MlZUV1RodVVtNDFlbll5TkhSUWJGSkdVVk5xZWtscWMxSlNhVVJvYzA1UWFGUlRhd3AxZGxkYVdI
      SjBWVlpoUlQwS1BVMDNMek1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  become: true
  tasks:
    - name: obtain diagnosis info
      command: \\"insights-client --diagnosis{{ insights_remediation | regex_search('\\\\\\\\s[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}') }}\\"
      register: insights_result
      changed_when: false
      check_mode: false
    - name: register insights report as fact for use by other plays
      set_fact: insights_report={{ insights_result.stdout }}

# Kernel vulnerable to local privilege escalation via DCCP module (CVE-2017-6074)
# Identifier: (advisor:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074,kernel_update)
# Version: NORMALIZED_PLACEHOLDER
- name: Update system to the latest kernel and reboot
  hosts: \\"1f12bdfc-8267-492d-a930-92f498fe65b9.ansible.example.com,fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  become: true
  vars:
    # determine if we need to update the 'kernel' package or 'kernel-rt' package
    kernel_pkg: \\"{{'kernel-rt' if 'rt' in ansible_kernel else 'kernel'}}\\"

  tasks:
    - name: Update kernel
      yum:
        name: \\"{{kernel_pkg}}\\"
        state: latest
      register: yum

    - when: yum|changed
      name: set reboot fact
      set_fact:
        insights_needs_reboot: True

    - when: not yum|changed
      # The latest kernel is already installed so boot from it.  Sort the installed kernels
      # by buildtime and select the one with the most recent build time
      block:
      - name: get latest installed {{kernel_pkg}} package version
        shell: rpm -q {{kernel_pkg}} --queryformat=\\"%{buildtime}\\\\t%{version}-%{release}.%{arch}\\\\n\\" | sort -nr | head -1 | cut -f2
        register: latest_kernel
        check_mode: no

      - name: get configured default kernel
        command: /sbin/grubby --default-kernel
        register: default_kernel
        check_mode: no

      - when: default_kernel.stdout.split('-', 1)[1] != latest_kernel.stdout
        name: set the default kernel to the latest installed
        command: /sbin/grubby --set-default /boot/vmlinuz-{{latest_kernel.stdout}}
        register: grub_change
        check_mode: no

      - when: grub_change|changed
        name: set reboot fact
        set_fact:
          insights_needs_reboot: True


# Bonding will not fail over to the backup link when bonding options are partially read
# Identifier: (advisor:network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE,fix)
# Version: NORMALIZED_PLACEHOLDER
- name: Correct Bonding Config Items
  hosts: \\"fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  become: true
  vars:
    pydata: \\"{{ insights_report.details['network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE'] }}\\"

  tasks:
    - when:
       - pydata.bond_config is defined
      block:
        - name: Add quotes around bonding options
          lineinfile:
            dest: \\"/etc/sysconfig/network-scripts/ifcfg-{{ item.key }}\\"
            regexp: '(^\\\\s*BONDING_OPTS=)(.*)'
            backrefs: yes
            line: '\\\\1\\"\\\\2\\"'
          with_dict: \\"{{ pydata.bond_config }}\\"

        - name: Restart Network Interfaces
          shell: ifdown {{item.key}}  && ifup {{item.key}}
          with_dict: \\"{{ pydata.bond_config }}\\"


# Disable the Automounter
# Identifier: (ssg:rhel7|standard|xccdf_org.ssgproject.content_rule_service_autofs_disabled,fix)
# Version: NORMALIZED_PLACEHOLDER
# platform = multi_platform_all
# complexity = low
# strategy = disable
# reboot = false
# disruption = low
- name: Disable the Automounter
  hosts: 'fc94beb8-21ee-403d-99b1-949ef7adb762'
  become: true
  tags:
    - CCE-27498-5
    - DISA-STIG-RHEL-07-020110
    - NIST-800-171-3.4.6
    - NIST-800-53-AC-19(a)
    - NIST-800-53-AC-19(d)
    - NIST-800-53-AC-19(e)
    - NIST-800-53-IA-3
    - disable_strategy
    - low_complexity
    - low_disruption
    - medium_severity
    - no_reboot_needed
    - service_autofs_disabled
  tasks:

    - name: Unit Service Exists - autofs.service
      command: systemctl list-unit-files autofs.service
      register: service_file_exists
      changed_when: false
      ignore_errors: true
      when: ansible_virtualization_role != \\"guest\\" or ansible_virtualization_type
        != \\"docker\\"

    - name: Disable service autofs
      systemd:
        name: autofs.service
        enabled: 'no'
        state: stopped
        masked: 'yes'
      when:
        - '\\"autofs.service\\" in service_file_exists.stdout_lines[1]'
        - ansible_virtualization_role != \\"guest\\" or ansible_virtualization_type !=
          \\"docker\\"

    - name: Unit Socket Exists - autofs.socket
      command: systemctl list-unit-files autofs.socket
      register: socket_file_exists
      changed_when: false
      ignore_errors: true
      when: ansible_virtualization_role != \\"guest\\" or ansible_virtualization_type
        != \\"docker\\"

    - name: Disable socket autofs
      systemd:
        name: autofs.socket
        enabled: 'no'
        state: stopped
        masked: 'yes'
      when:
        - '\\"autofs.socket\\" in socket_file_exists.stdout_lines[1]'
        - ansible_virtualization_role != \\"guest\\" or ansible_virtualization_type !=
          \\"docker\\"


# Upgrade packages affected by CVE-2017-5715
# Identifier: (vulnerabilities:CVE-2017-5715,fix)
# Version: test
- name: update vulnerable packages
  hosts: \\"fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  vars:
    insights_issues: \\"--cve CVE-2017-5715\\"
    insights_signature_exclude: /hosts,/vars/insights_signature,/vars/insights_issues
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldWTmFUMGM0ZG5jMU9FUXJhalZ3VGtGUmFFVnpRUzh2VW1OSFFU
      TjFLM2RDVFdOYWJTOTNheTlOVVVKRGVua3pRWEZsZG1Jd1NIa0tlRFZtTUZKWVoybHROVkpKTkRs
      YVVIYzRVak5EZDJGM1l6QTNUa0V5TjJOSFltWkRlbTF5TWpaR00zazNSemRKZG5ReldUUkpURGhs
      YUhsWmFHUm5SZ3B4YTIwMk5uWkllVWRsTmxnNWVWVmpjblJrUzNOWlFXRjFNWE0wTkhSVU5IQnJh
      MUpUYWl0VlJ6bHBUbGxWVEdzelUyRlNTMU5ZV0cxdFpVRnhiRXRZQ2tOMFV6a3hUVVpYWWtsS00z
      ZHlibTF0VFhKUmRXaDRlVUYwTW14TllWUnFkMDU1VDFoalRuQjFWR0pQWVZoSlRIRkROV1YwZFdn
      elRtZFpkV0ZLVVVFS2NVa3dZV3hNU21obWNsSkpVMlJLTkVNeU5YRk1aa2M0U2tKb1RXMTNRVkUy
      VlhaM2N6VTJZaXRhZDIxWGEyTllaM28xV1ZwWVNHbERaMjF3V0ZNeFJncG9SbE0xVlU1YWNrYzNP
      QzlTVGxGVmFHRTBiMkVyTDNsck5WWm5UVlZsYkVSV1EwaHhSMFk1YVdkWlVtdENiVk5UZFROc1RW
      cFZZbU53Wms5eU5DdE9DbUZxVTJoSGRXaHdhMjlzTTFOSFNVWTFaVVZLYW5CWGFURlJSak52UTFS
      UWVtMXVjM0p1TTNWWlpYTmtObWhCU1RGcFpIVnJVVGg1UW1sbk1EaExiR2NLU1hnNGMwaE9UeXQ0
      TUhWcVJrRlVWalpDV2pCUU9HOUViREpHTjFCSlkwSkxWMnRsWldGM1pGaGFNWEpNVFRVNGVESnJa
      V1J3VG14WldIaG1aems0VEFwRVlrZHJSVUpDVFd4MU1uUjJia2w2V0RsamNqUnVNVXRKZEZsTFpr
      ZGhUbkpUYkZsWVJ6bG5TbG92YUZsTUt6ZHhPRk5TU2tsb1FUSkZkRTF4Y1VndkNteFVWVUpYZDBO
      aVRuSnJjM1pGTWk5WE1VTnRTWHBOVDNsRVZuSTVibkZLTDFVclVYQnFWMU5HY2tWb1JHZEpOazFs
      WWtOblR6SnVXVmxVTnpoM1MwZ0tSVWs1T1doblF5OHJOSGRYZFVkeVFVSmtlbnBLWm14YVpXZHRO
      RTVaSzBOTFNHOXVUa28yYmxKaVYxUlhaMDV5TjFrM2VVcGhiVVZRUTFsd1FYTnlSZ3BpTTJveU1G
      cEhWblp3TkQwS1BUaDBjbkFLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  become: true
  tasks:
    - name: check for update
      shell: \\"{{ ansible_facts['pkg_mgr'] }} check-update -q {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\\\\\\\s*)+') }}\\"
      check_mode: no
      register: check_out
      failed_when: check_out.rc != 0 and check_out.rc != 100

    - when: check_out.rc == 100
      name: upgrade package
      shell: \\"{{ ansible_facts['pkg_mgr'] }} upgrade -v -y {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\\\\\\\s*)+') }}\\"

    - when: check_out.rc == 100
      name: set reboot fact
      set_fact:
        insights_needs_reboot: true

# Fixes vulnerabilities:CVE-2017-5715:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074
# Identifier: (vulnerabilities:CVE-2017-5715:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074,fix)
# Version: unknown
- name: Correct Bonding Config Items
  hosts: \\"fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  become: true
  vars:
    pydata: \\"{{ insights_report.details['CVE_2017_6074_kernel|KERNEL_CVE_2017_6074'] }}\\"

  tasks:
    - when:
       - pydata.bond_config is defined
      block:
        - name: Add quotes around bonding options
          lineinfile:
            dest: \\"/etc/sysconfig/network-scripts/ifcfg-{{ item.key }}\\"
            regexp: '(^\\\\s*BONDING_OPTS=)(.*)'
            backrefs: yes
            line: '\\\\1\\"\\\\2\\"'
          with_dict: \\"{{ pydata.bond_config }}\\"

        - name: Restart Network Interfaces
          shell: ifdown {{item.key}}  && ifup {{item.key}}
          with_dict: \\"{{ pydata.bond_config }}\\"


# Apply RHSA-2018:0502
# Identifier: (vulnerabilities:RHSA-2018:0502,fix)
# Version: test
- name: update packages
  hosts: \\"fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  vars:
    insights_issues: \\"--advisory RHSA-2018:0502\\"
    requires_reboot: \\"true\\"
    insights_signature_exclude: \\"/hosts,/vars/insights_signature,/vars/insights_issues,/vars/requires_reboot\\"
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldWaEVNVEE0ZG5jMU9FUXJhalZ3VGtGUmFTdDVRUzg1UmpKck0y
      RjFNaXN6YWpBdmRVNXJMek5FZVRRclJrRXdXWGREY0Zsd05pOEtOSGQxYUZKRk1IUkpZVWhvWVdK
      aU9VRndlR1JzUjBnNFVtWXJWSFJ3Vm1aR2J6WmpWbVJNVml0clJqSnZLelZKVDNjd1JHaGplVFJS
      VTNCdmJEUjBTQXB4VDI1amMyWjJNelJ2VGxGVk5rUmxjMjA0UkZCbGJURlJZWEJhYm01bVlrdExZ
      MU5uUW00clpsRjVPSEprZVVSR2VrcG9RMGMxWVVwb1VsY3pWR2d2Q2xFelRGVTNNbFJxWVVWSWMy
      STVRM2h5TlZaamFuUnJkMWczYzFWSGFFWkRkM05FVEVKSVJFVnJiMjk0UzA5TWVVRjRWbTB4ZEVs
      T1RGaHdWa3hKTkdvS2Eya3llVXRHZERkYVpERjZPRWc0WVc1bFJsSmpUMmR1T0c1cGVGQnBRMDE2
      YjBwMVkxbHdUMVpYTjNVMk1tMDVXVWhxVUZkRE9YUnBLMWhSUlRNNUx3cFpXR1pYVlVWVU5GaE1k
      ekZyYldkYVRFMDNkMUl5UkdkaVVXWXdOMVU1WkU5TVdFSnZNRzF5WVZaVFFUTmxZVFZ6U2xKc2RH
      bEJhVGxRTlhVemRGSnNDa2xzVTNGNmF6ZHpNMHRHTmpCNGJFWkVSVmwyTmpOb2FVdHRaM3BLZUVk
      NlptdzBNVEZyVWxKdlVVbzJTRVI0UjBGTFFVZG5OMlkzWTFSUlRWTlpjRTRLTUU1TFZubFZPVmRV
      ZFdkWmRXTjZhRk5vWVRGSFpsUXpiMFp3UjBGV05HaG1TSFpEYlRkUE9ESmtiQzhyZERSSGVsbEtO
      VmxPUkZoNVkwb3lPVTR6U1FwbldsUlRPRVJTVFZOSFJFaE9ha1J0UlZnNVdYRm1halkxVFhkS1Vr
      UkdVa3hNTjFaV1EzQktOa1ZQWlRSQ1VHdFJSbFp2UzI1aVJtaDNTbWg1VW1ScENuSjRTelJ1YnpS
      ME9GYzNlRFpIZVN0VVIzcDZSMVJ4UWxJMUsxZHROVzlLWVZoU1ptNXNkbmRtVGt0NU5HaDFObUZM
      ZVVOWVlUWnNLMFY1ZDNWd2VVb0tNSEZ2TjBKWVVsTnlNM3BqWjJjdmJXb3hjSGRKY0ZwcE1HSnlO
      elpRUWt3cmEzSk1TVVpKYjJKVU4xcEVkR1ptZGpCQk5VNTFNV05xZHpnMVZuUTFkQXB4TlZCcFpF
      cGpUMDFDTUQwS1BXbE9UemtLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  become: true
  tasks:
    - name: check for update
      shell: \\"{{ ansible_facts['pkg_mgr'] }} check-update -q {{ insights_issues | regex_search('(--advisory ((FEDORA-EPEL-[\\\\\\\\w-]+)|(RH[SBE]A-20[\\\\\\\\d]{2}:[\\\\\\\\d]{4,5}))\\\\\\\\s*)+') }}\\"
      check_mode: no
      register: check_out
      failed_when: check_out.rc != 0 and check_out.rc != 100

    - when: check_out.rc == 100
      name: upgrade package
      shell: \\"{{ ansible_facts['pkg_mgr'] }} update -d 2 -y {{ insights_issues | regex_search('(--advisory ((FEDORA-EPEL-[\\\\\\\\w-]+)|(RH[SBE]A-20[\\\\\\\\d]{2}:[\\\\\\\\d]{4,5}))\\\\\\\\s*)+') }}\\"

    - when: check_out.rc == 100
      name: set reboot fact
      set_fact:
        insights_needs_reboot: \\"{{requires_reboot}}\\"

# Reboots a system if any of the preceeding plays sets the 'insights_needs_reboot' variable to true.
# The variable can be overridden to suppress this behavior.
- name: Reboot system (if applicable)
  hosts: \\"1f12bdfc-8267-492d-a930-92f498fe65b9.ansible.example.com,fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRMVk0ZG5jMU9FUXJhalZ3VGtGUmFrMUVRa0ZCYTJOeE1W
      WlhVbEF3VUVoMGRIRjBWMGt4UkZSdU4zcE1kbFUyU0hKd2QxSUtUbkJ3Um5SWGJWRktiM2xxYm1w
      bE5XUmFSemMxUTNCU1kzZGFPRU5XVW5sRlRVRXpVREExZW1Kc1UzSnFWbTUxVW5oNlpVeG1SbTFy
      YW1SRVJWcHdjZ3ByWTJ0d2FFazJSVUpIYWtJemEyaGFUalJ5YTNwUWRWQm1PR1pMUVdsSE1ESmxk
      SGhXVFZWV01tZHRkV3c0UjBJMmRIcEpkRk5uVFRGQlFYQkdORTFRQ2s1NFRDOUpUMlY2ZFdRMGFt
      VlFaV05KZWpGS1dtMTVkVGgzWTNoVFZqWkpTbTVPU1VGSGVHYzVWRUpVYzNNMFEwbHVaVlZXY0RG
      VWRrUlFPUzlHVXk4S2VGaFlaMFphWlM5VlZuQjBaRzA1ZDJkbmRVOXRiR2hvWVZCTVZHNU5Tbkoy
      UVRsV2FVUnZRVzV2WWt0b1VIbEtZMHBSYjJOTFdrRlRjVTF6ZWs1VWNncHVNek5JYlRoUk9IQnRW
      VTFLYldobU9VRnZkM2x4VW5GWVVHeHpXVGwzT0UxRU1WQkZjR3htY2pJeVlYTjFMMHhvYjNGNlIz
      TmtOMUUxTTJwdFMyNXBDaXM1Y0VjeWEzVkNSVXhpVVhoblRHcERiVlZsUzFCdmJuaFhjM0JuVFZs
      M2VYQjFaVFJvYnl0dmFsZG5WRGR2ZG1GbFRFNVRTMkV2UkZOS2JEWldRaThLZEd4YUwxUXJPRFZr
      Ym5ZclNWb3phbEJTZFM5bVpuZFBkVVpVV2xoNmVGTkJUalZSV1M5ak15c3hhbUZSTDBKeFdYTmhi
      M2RpUkZreGRXUXZVeXRsYVFwa2FEa3JWRkV5TlVKa1NYa3hibGh3ZWpoV1JHbHpjbEp3Y0VrNWFs
      SldWakkwTVVVelRVWkhka1ZaTm1aVFYzSlZWMWMzY0RKbFpUbGphelpOVlUweUNrNUZjRXBLWm5G
      UFNFdHBjRXRPZVRKdVFVRTJURmcxTHpNeGFWSk9VSEZZVXpKRVdqSlpkbVZTUTJOMmVDOHZPVTlo
      UzFWd1FsZElZVmxYYW5STU4wWUtSWFJWVEZGeFZESkJPVTF3WjFSU1RtOU5WbEZ4Y1haQ01GUlBP
      WE00TmxoTmRuUkdRa1IzYW5SbWIxSm9NRnBEYlUwME1FRlhRMHBxT0RKNlduTlRZUXBCYXpkUEsy
      UkpkMFl5VVQwS1BWcEtiallLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - when:
        - insights_needs_reboot is defined
        - insights_needs_reboot
      block:
        - name: Reboot system
          shell: sleep 2 && shutdown -r now \\"Ansible triggered reboot\\"
          async: 1
          poll: 0
          ignore_errors: true

        - name: Wait for system to boot up
          local_action:
            module: wait_for
            host: \\"{{ hostvars[inventory_hostname]['ansible_host'] | default(hostvars[inventory_hostname]['ansible_ssh_host'], true) | default(inventory_hostname, true) }}\\"
            port: \\"{{ hostvars[inventory_hostname]['ansible_port'] | default(hostvars[inventory_hostname]['ansible_ssh_port'], true) | default('22', true) }}\\"
            delay: 15
            search_regex: OpenSSH
            timeout: 300
          become: false

- name: run insights
  hosts: \\"1f12bdfc-8267-492d-a930-92f498fe65b9.ansible.example.com,fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate playbook with suppressed reboot 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# Remediation with suppressed reboot
# https://console.redhat.com/insights/remediations/178cf0c8-35dd-42a3-96d5-7b50f9d211f6
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by tuser@redhat.com

# Kernel vulnerable to local privilege escalation via DCCP module (CVE-2017-6074)
# Identifier: (advisor:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074,kernel_update)
# Version: 3f74744ce9b66c20b55f6dd4e580d77d7e7039b1
- name: Update system to the latest kernel and reboot
  hosts: \\"fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  become: true
  vars:
    # determine if we need to update the 'kernel' package or 'kernel-rt' package
    kernel_pkg: \\"{{'kernel-rt' if 'rt' in ansible_kernel else 'kernel'}}\\"

  tasks:
    - name: Update kernel
      yum:
        name: \\"{{kernel_pkg}}\\"
        state: latest
      register: yum

    - when: yum|changed
      name: set reboot fact
      set_fact:
        insights_needs_reboot: True

    - when: not yum|changed
      # The latest kernel is already installed so boot from it.  Sort the installed kernels
      # by buildtime and select the one with the most recent build time
      block:
      - name: get latest installed {{kernel_pkg}} package version
        shell: rpm -q {{kernel_pkg}} --queryformat=\\"%{buildtime}\\\\t%{version}-%{release}.%{arch}\\\\n\\" | sort -nr | head -1 | cut -f2
        register: latest_kernel
        check_mode: no

      - name: get configured default kernel
        command: /sbin/grubby --default-kernel
        register: default_kernel
        check_mode: no

      - when: default_kernel.stdout.split('-', 1)[1] != latest_kernel.stdout
        name: set the default kernel to the latest installed
        command: /sbin/grubby --set-default /boot/vmlinuz-{{latest_kernel.stdout}}
        register: grub_change
        check_mode: no

      - when: grub_change|changed
        name: set reboot fact
        set_fact:
          insights_needs_reboot: True


# Automatic system reboot was suppressed for this playbook.
# This play lists the systems that need to be rebooted manually for the changes to take effect.
- name: Reboot reminder
  hosts: \\"fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRekZ6ZG5jMU9FUXJhalZ3VGtGUmFHaDNkeTh2VVV4SFJE
      aFFNM1l3VlhKWmRFUldabGhaUWxWSFNGQkpUbkpNV1ZCNFFUUUtXWFJXUmtFd1ZXb3diWGhyVVVG
      RFNtbHNZbVJGYVVWdVJIaFVZMVpDZDFSMlpVd3dTVWR0Um5sVVZVWkRVVEZ6WkdRMVUwc3JRMlJy
      TjJKa2RHTmliQW81TlRkaWJtZzVXbk5xYm14dWEwOU5ObTlyVFhVNFNraDZSMDFRV1hST01VaHdR
      VGxJYVV4Mk9IaEdPSFYzTmtkMWQycE9PREJ5ZDNaMmVIZG1WWEpOQ2psWFdYZE1PVU51UzJaRk16
      QnVOM04wTDA1TGJFbDFMMmd3Y2pKU1JTc3hPV1Z0TUdodVJsQmhaa2RwT1RZeWRXaFVTRGhZYzB4
      VWVHOXlRekZhU0c4S09VeENlRU5PVWsxc1draGljVGhzYVd0UVJsaFBhekkxTlNzdmFXMUdkazlE
      V1hwT1RuRXpkVkYxTDB0SWFGTTVhemRaT0Vwb0wyRjZTRFYzYW5KNlV3cDNNekJ1Y25JeVNVOW1j
      V0V2VUdWRlJXOU5SbUV3UVV4WWRFZFVSREpyWmk5Q1pIVXlSemRUU0hkMFNsaG9VbEJzVnpKNU9H
      MW1Za2wwY0UxYWMyTlFDbFp2WkhoVmEwbGtkVXhUTmpaM04wODBPRTVRT1V0Uk9XbE9Wa2hCTVdo
      NVZTOTFWekkwT1ZFd2EwWjZlR3BEUVhsR1QwY3pabkZRUkhWaWNVeFlkbkFLTjB0bFJGWklRbFpS
      UVVkckwwUnhSMFpYT0hoMlVUUkZkSEpVTldrMlVsb3hVRlJMZEZCVmNrVmpRV2hoU2xsWlMwRm9X
      U3R4Y2pkUE1WSkhkazFxUlFwTlEzbFFjVlZ1U0hJMFNHSmtjelJTU0drNVJucFFaeXN2VjB0M2F6
      VnRhMUJMTUUxaEsyMUxkVXd5YTI1elUwaDFTakEzVkVVMk1HNU1WbGM0YTFwakNsSllibGxCU1ZB
      d1RGUnRUMHhvWms0NWJtdzVOM2hvUTNSUFdrZFBjMVp3WVhWdlIyZENOV0ZrV1ZGYVZXY3JSVzF0
      UldSQ1ZrdDZOVUp2VERWc1pYTUtVMjVQVkd3dmFEbG9hekpqYm0xVVdWRTFRa1JoY1RSdGR6QnFS
      SGhDTjFWUWNVdDFZazFDUTJoSVdIUnRVRFpGT1hSU1pYRnNiWHB0YWxkR2QxWnpZd3B1TDBGRFpW
      ZzFZVUUxY3owS1BXZHFZbWdLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - debug:
        msg: \\"Automatic system reboot was suppressed for this playbook. Reboot {{inventory_hostname}} manually for the changes to take effect.\\"
      when:
        - insights_needs_reboot is defined
        - insights_needs_reboot

- name: run insights
  hosts: \\"fc94beb8-21ee-403d-99b1-949ef7adb762\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks generate stores generated playbooks 1`] = `
Object {
  "account_number": "testReadSingle",
  "definition": "{\\"version\\":\\"test\\",\\"auto_reboot\\":true,\\"issues\\":[{\\"id\\":\\"vulnerabilities:CVE-2017-5715\\",\\"resolution\\":\\"fix\\",\\"version\\":\\"test\\",\\"hosts\\":[\\"84762eb3-0bbb-4bd8-ab11-f420c50e9000.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9001.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9002.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9003.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9004.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9005.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9006.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9007.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9008.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9009.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9010.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9011.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9012.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9013.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9014.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9015.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9016.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9017.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9018.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9019.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9020.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9021.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9022.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9023.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9024.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9025.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9026.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9027.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9028.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9029.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9030.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9031.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9032.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9033.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9034.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9035.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9036.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9037.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9038.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9039.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9040.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9041.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9042.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9043.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9044.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9045.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9046.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9047.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9048.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9049.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9050.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9051.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9052.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9053.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9054.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9055.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9056.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9057.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9058.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9059.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9060.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9061.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9062.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9063.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9064.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9065.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9066.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9067.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9068.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9069.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9070.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9071.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9072.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9073.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9074.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9075.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9076.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9077.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9078.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9079.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9080.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9081.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9082.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9083.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9084.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9085.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9086.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9087.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9088.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9089.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9090.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9091.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9092.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9093.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9094.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9095.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9096.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9097.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9098.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9099.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9100.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9101.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9102.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9103.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9104.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9105.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9106.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9107.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9108.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9109.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9110.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9111.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9112.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9113.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9114.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9115.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9116.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9117.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9118.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9119.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9120.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9121.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9122.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9123.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9124.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9125.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9126.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9127.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9128.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9129.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9130.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9131.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9132.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9133.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9134.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9135.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9136.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9137.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9138.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9139.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9140.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9141.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9142.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9143.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9144.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9145.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9146.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9147.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9148.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9149.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9150.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9151.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9152.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9153.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9154.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9155.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9156.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9157.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9158.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9159.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9160.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9161.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9162.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9163.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9164.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9165.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9166.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9167.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9168.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9169.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9170.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9171.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9172.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9173.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9174.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9175.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9176.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9177.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9178.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9179.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9180.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9181.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9182.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9183.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9184.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9185.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9186.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9187.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9188.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9189.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9190.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9191.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9192.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9193.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9194.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9195.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9196.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9197.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9198.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9199.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9200.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9201.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9202.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9203.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9204.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9205.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9206.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9207.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9208.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9209.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9210.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9211.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9212.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9213.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9214.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9215.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9216.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9217.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9218.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9219.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9220.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9221.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9222.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9223.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9224.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9225.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9226.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9227.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9228.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9229.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9230.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9231.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9232.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9233.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9234.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9235.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9236.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9237.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9238.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9239.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9240.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9241.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9242.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9243.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9244.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9245.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9246.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9247.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9248.example.com\\",\\"84762eb3-0bbb-4bd8-ab11-f420c50e9249.example.com\\"]}]}",
  "username": "testReadSingleUser",
}
`;

exports[`playbooks missing get remediation with missing system 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# missing system 1
# https://console.redhat.com/insights/remediations/82aeb63f-fc25-4eef-9333-4fa7e10f7217
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Kernel vulnerable to local privilege escalation via DCCP module (CVE-2017-6074)
# Identifier: (advisor:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074,kernel_update)
# Version: 3f74744ce9b66c20b55f6dd4e580d77d7e7039b1
- name: Update system to the latest kernel and reboot
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  become: true
  vars:
    # determine if we need to update the 'kernel' package or 'kernel-rt' package
    kernel_pkg: \\"{{'kernel-rt' if 'rt' in ansible_kernel else 'kernel'}}\\"

  tasks:
    - name: Update kernel
      yum:
        name: \\"{{kernel_pkg}}\\"
        state: latest
      register: yum

    - when: yum|changed
      name: set reboot fact
      set_fact:
        insights_needs_reboot: True

    - when: not yum|changed
      # The latest kernel is already installed so boot from it.  Sort the installed kernels
      # by buildtime and select the one with the most recent build time
      block:
      - name: get latest installed {{kernel_pkg}} package version
        shell: rpm -q {{kernel_pkg}} --queryformat=\\"%{buildtime}\\\\t%{version}-%{release}.%{arch}\\\\n\\" | sort -nr | head -1 | cut -f2
        register: latest_kernel
        check_mode: no

      - name: get configured default kernel
        command: /sbin/grubby --default-kernel
        register: default_kernel
        check_mode: no

      - when: default_kernel.stdout.split('-', 1)[1] != latest_kernel.stdout
        name: set the default kernel to the latest installed
        command: /sbin/grubby --set-default /boot/vmlinuz-{{latest_kernel.stdout}}
        register: grub_change
        check_mode: no

      - when: grub_change|changed
        name: set reboot fact
        set_fact:
          insights_needs_reboot: True


# Reboots a system if any of the preceeding plays sets the 'insights_needs_reboot' variable to true.
# The variable can be overridden to suppress this behavior.
- name: Reboot system (if applicable)
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRMVk0ZG5jMU9FUXJhalZ3VGtGUmFrMUVRa0ZCYTJOeE1W
      WlhVbEF3VUVoMGRIRjBWMGt4UkZSdU4zcE1kbFUyU0hKd2QxSUtUbkJ3Um5SWGJWRktiM2xxYm1w
      bE5XUmFSemMxUTNCU1kzZGFPRU5XVW5sRlRVRXpVREExZW1Kc1UzSnFWbTUxVW5oNlpVeG1SbTFy
      YW1SRVJWcHdjZ3ByWTJ0d2FFazJSVUpIYWtJemEyaGFUalJ5YTNwUWRWQm1PR1pMUVdsSE1ESmxk
      SGhXVFZWV01tZHRkV3c0UjBJMmRIcEpkRk5uVFRGQlFYQkdORTFRQ2s1NFRDOUpUMlY2ZFdRMGFt
      VlFaV05KZWpGS1dtMTVkVGgzWTNoVFZqWkpTbTVPU1VGSGVHYzVWRUpVYzNNMFEwbHVaVlZXY0RG
      VWRrUlFPUzlHVXk4S2VGaFlaMFphWlM5VlZuQjBaRzA1ZDJkbmRVOXRiR2hvWVZCTVZHNU5Tbkoy
      UVRsV2FVUnZRVzV2WWt0b1VIbEtZMHBSYjJOTFdrRlRjVTF6ZWs1VWNncHVNek5JYlRoUk9IQnRW
      VTFLYldobU9VRnZkM2x4VW5GWVVHeHpXVGwzT0UxRU1WQkZjR3htY2pJeVlYTjFMMHhvYjNGNlIz
      TmtOMUUxTTJwdFMyNXBDaXM1Y0VjeWEzVkNSVXhpVVhoblRHcERiVlZsUzFCdmJuaFhjM0JuVFZs
      M2VYQjFaVFJvYnl0dmFsZG5WRGR2ZG1GbFRFNVRTMkV2UkZOS2JEWldRaThLZEd4YUwxUXJPRFZr
      Ym5ZclNWb3phbEJTZFM5bVpuZFBkVVpVV2xoNmVGTkJUalZSV1M5ak15c3hhbUZSTDBKeFdYTmhi
      M2RpUkZreGRXUXZVeXRsYVFwa2FEa3JWRkV5TlVKa1NYa3hibGh3ZWpoV1JHbHpjbEp3Y0VrNWFs
      SldWakkwTVVVelRVWkhka1ZaTm1aVFYzSlZWMWMzY0RKbFpUbGphelpOVlUweUNrNUZjRXBLWm5G
      UFNFdHBjRXRPZVRKdVFVRTJURmcxTHpNeGFWSk9VSEZZVXpKRVdqSlpkbVZTUTJOMmVDOHZPVTlo
      UzFWd1FsZElZVmxYYW5STU4wWUtSWFJWVEZGeFZESkJPVTF3WjFSU1RtOU5WbEZ4Y1haQ01GUlBP
      WE00TmxoTmRuUkdRa1IzYW5SbWIxSm9NRnBEYlUwME1FRlhRMHBxT0RKNlduTlRZUXBCYXpkUEsy
      UkpkMFl5VVQwS1BWcEtiallLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - when:
        - insights_needs_reboot is defined
        - insights_needs_reboot
      block:
        - name: Reboot system
          shell: sleep 2 && shutdown -r now \\"Ansible triggered reboot\\"
          async: 1
          poll: 0
          ignore_errors: true

        - name: Wait for system to boot up
          local_action:
            module: wait_for
            host: \\"{{ hostvars[inventory_hostname]['ansible_host'] | default(hostvars[inventory_hostname]['ansible_ssh_host'], true) | default(inventory_hostname, true) }}\\"
            port: \\"{{ hostvars[inventory_hostname]['ansible_port'] | default(hostvars[inventory_hostname]['ansible_ssh_port'], true) | default('22', true) }}\\"
            delay: 15
            search_regex: OpenSSH
            timeout: 300
          become: false

- name: run insights
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks missing get remediation with missing system causing an issue to be empty 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# missing system 2
# https://console.redhat.com/insights/remediations/27e36e14-e1c2-4b5a-9382-ec80ca9a6c1a
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Kernel vulnerable to local privilege escalation via DCCP module (CVE-2017-6074)
# Identifier: (advisor:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074,kernel_update)
# Version: 3f74744ce9b66c20b55f6dd4e580d77d7e7039b1
- name: Update system to the latest kernel and reboot
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  become: true
  vars:
    # determine if we need to update the 'kernel' package or 'kernel-rt' package
    kernel_pkg: \\"{{'kernel-rt' if 'rt' in ansible_kernel else 'kernel'}}\\"

  tasks:
    - name: Update kernel
      yum:
        name: \\"{{kernel_pkg}}\\"
        state: latest
      register: yum

    - when: yum|changed
      name: set reboot fact
      set_fact:
        insights_needs_reboot: True

    - when: not yum|changed
      # The latest kernel is already installed so boot from it.  Sort the installed kernels
      # by buildtime and select the one with the most recent build time
      block:
      - name: get latest installed {{kernel_pkg}} package version
        shell: rpm -q {{kernel_pkg}} --queryformat=\\"%{buildtime}\\\\t%{version}-%{release}.%{arch}\\\\n\\" | sort -nr | head -1 | cut -f2
        register: latest_kernel
        check_mode: no

      - name: get configured default kernel
        command: /sbin/grubby --default-kernel
        register: default_kernel
        check_mode: no

      - when: default_kernel.stdout.split('-', 1)[1] != latest_kernel.stdout
        name: set the default kernel to the latest installed
        command: /sbin/grubby --set-default /boot/vmlinuz-{{latest_kernel.stdout}}
        register: grub_change
        check_mode: no

      - when: grub_change|changed
        name: set reboot fact
        set_fact:
          insights_needs_reboot: True


# Reboots a system if any of the preceeding plays sets the 'insights_needs_reboot' variable to true.
# The variable can be overridden to suppress this behavior.
- name: Reboot system (if applicable)
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRMVk0ZG5jMU9FUXJhalZ3VGtGUmFrMUVRa0ZCYTJOeE1W
      WlhVbEF3VUVoMGRIRjBWMGt4UkZSdU4zcE1kbFUyU0hKd2QxSUtUbkJ3Um5SWGJWRktiM2xxYm1w
      bE5XUmFSemMxUTNCU1kzZGFPRU5XVW5sRlRVRXpVREExZW1Kc1UzSnFWbTUxVW5oNlpVeG1SbTFy
      YW1SRVJWcHdjZ3ByWTJ0d2FFazJSVUpIYWtJemEyaGFUalJ5YTNwUWRWQm1PR1pMUVdsSE1ESmxk
      SGhXVFZWV01tZHRkV3c0UjBJMmRIcEpkRk5uVFRGQlFYQkdORTFRQ2s1NFRDOUpUMlY2ZFdRMGFt
      VlFaV05KZWpGS1dtMTVkVGgzWTNoVFZqWkpTbTVPU1VGSGVHYzVWRUpVYzNNMFEwbHVaVlZXY0RG
      VWRrUlFPUzlHVXk4S2VGaFlaMFphWlM5VlZuQjBaRzA1ZDJkbmRVOXRiR2hvWVZCTVZHNU5Tbkoy
      UVRsV2FVUnZRVzV2WWt0b1VIbEtZMHBSYjJOTFdrRlRjVTF6ZWs1VWNncHVNek5JYlRoUk9IQnRW
      VTFLYldobU9VRnZkM2x4VW5GWVVHeHpXVGwzT0UxRU1WQkZjR3htY2pJeVlYTjFMMHhvYjNGNlIz
      TmtOMUUxTTJwdFMyNXBDaXM1Y0VjeWEzVkNSVXhpVVhoblRHcERiVlZsUzFCdmJuaFhjM0JuVFZs
      M2VYQjFaVFJvYnl0dmFsZG5WRGR2ZG1GbFRFNVRTMkV2UkZOS2JEWldRaThLZEd4YUwxUXJPRFZr
      Ym5ZclNWb3phbEJTZFM5bVpuZFBkVVpVV2xoNmVGTkJUalZSV1M5ak15c3hhbUZSTDBKeFdYTmhi
      M2RpUkZreGRXUXZVeXRsYVFwa2FEa3JWRkV5TlVKa1NYa3hibGh3ZWpoV1JHbHpjbEp3Y0VrNWFs
      SldWakkwTVVVelRVWkhka1ZaTm1aVFYzSlZWMWMzY0RKbFpUbGphelpOVlUweUNrNUZjRXBLWm5G
      UFNFdHBjRXRPZVRKdVFVRTJURmcxTHpNeGFWSk9VSEZZVXpKRVdqSlpkbVZTUTJOMmVDOHZPVTlo
      UzFWd1FsZElZVmxYYW5STU4wWUtSWFJWVEZGeFZESkJPVTF3WjFSU1RtOU5WbEZ4Y1haQ01GUlBP
      WE00TmxoTmRuUkdRa1IzYW5SbWIxSm9NRnBEYlUwME1FRlhRMHBxT0RKNlduTlRZUXBCYXpkUEsy
      UkpkMFl5VVQwS1BWcEtiallLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - when:
        - insights_needs_reboot is defined
        - insights_needs_reboot
      block:
        - name: Reboot system
          shell: sleep 2 && shutdown -r now \\"Ansible triggered reboot\\"
          async: 1
          poll: 0
          ignore_errors: true

        - name: Wait for system to boot up
          local_action:
            module: wait_for
            host: \\"{{ hostvars[inventory_hostname]['ansible_host'] | default(hostvars[inventory_hostname]['ansible_ssh_host'], true) | default(inventory_hostname, true) }}\\"
            port: \\"{{ hostvars[inventory_hostname]['ansible_port'] | default(hostvars[inventory_hostname]['ansible_ssh_port'], true) | default('22', true) }}\\"
            delay: 15
            search_regex: OpenSSH
            timeout: 300
          become: false

- name: run insights
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks missing get remediation with unknown issues 1`] = `""`;

exports[`playbooks missing get remediation with unknown resolution 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# unknown resolution
# https://console.redhat.com/insights/remediations/ea5b1507-4cd3-4c87-aa5a-6c755d32a7bd
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Upgrade packages affected by CVE-2017-5715
# Identifier: (vulnerabilities:CVE-2017-5715,fix)
# Version: test
- name: update vulnerable packages
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  vars:
    insights_issues: \\"--cve CVE-2017-5715\\"
    insights_signature_exclude: /hosts,/vars/insights_signature,/vars/insights_issues
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldWTmFUMGM0ZG5jMU9FUXJhalZ3VGtGUmFFVnpRUzh2VW1OSFFU
      TjFLM2RDVFdOYWJTOTNheTlOVVVKRGVua3pRWEZsZG1Jd1NIa0tlRFZtTUZKWVoybHROVkpKTkRs
      YVVIYzRVak5EZDJGM1l6QTNUa0V5TjJOSFltWkRlbTF5TWpaR00zazNSemRKZG5ReldUUkpURGhs
      YUhsWmFHUm5SZ3B4YTIwMk5uWkllVWRsTmxnNWVWVmpjblJrUzNOWlFXRjFNWE0wTkhSVU5IQnJh
      MUpUYWl0VlJ6bHBUbGxWVEdzelUyRlNTMU5ZV0cxdFpVRnhiRXRZQ2tOMFV6a3hUVVpYWWtsS00z
      ZHlibTF0VFhKUmRXaDRlVUYwTW14TllWUnFkMDU1VDFoalRuQjFWR0pQWVZoSlRIRkROV1YwZFdn
      elRtZFpkV0ZLVVVFS2NVa3dZV3hNU21obWNsSkpVMlJLTkVNeU5YRk1aa2M0U2tKb1RXMTNRVkUy
      VlhaM2N6VTJZaXRhZDIxWGEyTllaM28xV1ZwWVNHbERaMjF3V0ZNeFJncG9SbE0xVlU1YWNrYzNP
      QzlTVGxGVmFHRTBiMkVyTDNsck5WWm5UVlZsYkVSV1EwaHhSMFk1YVdkWlVtdENiVk5UZFROc1RW
      cFZZbU53Wms5eU5DdE9DbUZxVTJoSGRXaHdhMjlzTTFOSFNVWTFaVVZLYW5CWGFURlJSak52UTFS
      UWVtMXVjM0p1TTNWWlpYTmtObWhCU1RGcFpIVnJVVGg1UW1sbk1EaExiR2NLU1hnNGMwaE9UeXQ0
      TUhWcVJrRlVWalpDV2pCUU9HOUViREpHTjFCSlkwSkxWMnRsWldGM1pGaGFNWEpNVFRVNGVESnJa
      V1J3VG14WldIaG1aems0VEFwRVlrZHJSVUpDVFd4MU1uUjJia2w2V0RsamNqUnVNVXRKZEZsTFpr
      ZGhUbkpUYkZsWVJ6bG5TbG92YUZsTUt6ZHhPRk5TU2tsb1FUSkZkRTF4Y1VndkNteFVWVUpYZDBO
      aVRuSnJjM1pGTWk5WE1VTnRTWHBOVDNsRVZuSTVibkZLTDFVclVYQnFWMU5HY2tWb1JHZEpOazFs
      WWtOblR6SnVXVmxVTnpoM1MwZ0tSVWs1T1doblF5OHJOSGRYZFVkeVFVSmtlbnBLWm14YVpXZHRO
      RTVaSzBOTFNHOXVUa28yYmxKaVYxUlhaMDV5TjFrM2VVcGhiVVZRUTFsd1FYTnlSZ3BpTTJveU1G
      cEhWblp3TkQwS1BUaDBjbkFLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  become: true
  tasks:
    - name: check for update
      shell: \\"{{ ansible_facts['pkg_mgr'] }} check-update -q {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\\\\\\\s*)+') }}\\"
      check_mode: no
      register: check_out
      failed_when: check_out.rc != 0 and check_out.rc != 100

    - when: check_out.rc == 100
      name: upgrade package
      shell: \\"{{ ansible_facts['pkg_mgr'] }} upgrade -v -y {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\\\\\\\s*)+') }}\\"

    - when: check_out.rc == 100
      name: set reboot fact
      set_fact:
        insights_needs_reboot: true

# Reboots a system if any of the preceeding plays sets the 'insights_needs_reboot' variable to true.
# The variable can be overridden to suppress this behavior.
- name: Reboot system (if applicable)
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRMVk0ZG5jMU9FUXJhalZ3VGtGUmFrMUVRa0ZCYTJOeE1W
      WlhVbEF3VUVoMGRIRjBWMGt4UkZSdU4zcE1kbFUyU0hKd2QxSUtUbkJ3Um5SWGJWRktiM2xxYm1w
      bE5XUmFSemMxUTNCU1kzZGFPRU5XVW5sRlRVRXpVREExZW1Kc1UzSnFWbTUxVW5oNlpVeG1SbTFy
      YW1SRVJWcHdjZ3ByWTJ0d2FFazJSVUpIYWtJemEyaGFUalJ5YTNwUWRWQm1PR1pMUVdsSE1ESmxk
      SGhXVFZWV01tZHRkV3c0UjBJMmRIcEpkRk5uVFRGQlFYQkdORTFRQ2s1NFRDOUpUMlY2ZFdRMGFt
      VlFaV05KZWpGS1dtMTVkVGgzWTNoVFZqWkpTbTVPU1VGSGVHYzVWRUpVYzNNMFEwbHVaVlZXY0RG
      VWRrUlFPUzlHVXk4S2VGaFlaMFphWlM5VlZuQjBaRzA1ZDJkbmRVOXRiR2hvWVZCTVZHNU5Tbkoy
      UVRsV2FVUnZRVzV2WWt0b1VIbEtZMHBSYjJOTFdrRlRjVTF6ZWs1VWNncHVNek5JYlRoUk9IQnRW
      VTFLYldobU9VRnZkM2x4VW5GWVVHeHpXVGwzT0UxRU1WQkZjR3htY2pJeVlYTjFMMHhvYjNGNlIz
      TmtOMUUxTTJwdFMyNXBDaXM1Y0VjeWEzVkNSVXhpVVhoblRHcERiVlZsUzFCdmJuaFhjM0JuVFZs
      M2VYQjFaVFJvYnl0dmFsZG5WRGR2ZG1GbFRFNVRTMkV2UkZOS2JEWldRaThLZEd4YUwxUXJPRFZr
      Ym5ZclNWb3phbEJTZFM5bVpuZFBkVVpVV2xoNmVGTkJUalZSV1M5ak15c3hhbUZSTDBKeFdYTmhi
      M2RpUkZreGRXUXZVeXRsYVFwa2FEa3JWRkV5TlVKa1NYa3hibGh3ZWpoV1JHbHpjbEp3Y0VrNWFs
      SldWakkwTVVVelRVWkhka1ZaTm1aVFYzSlZWMWMzY0RKbFpUbGphelpOVlUweUNrNUZjRXBLWm5G
      UFNFdHBjRXRPZVRKdVFVRTJURmcxTHpNeGFWSk9VSEZZVXpKRVdqSlpkbVZTUTJOMmVDOHZPVTlo
      UzFWd1FsZElZVmxYYW5STU4wWUtSWFJWVEZGeFZESkJPVTF3WjFSU1RtOU5WbEZ4Y1haQ01GUlBP
      WE00TmxoTmRuUkdRa1IzYW5SbWIxSm9NRnBEYlUwME1FRlhRMHBxT0RKNlduTlRZUXBCYXpkUEsy
      UkpkMFl5VVQwS1BWcEtiallLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - when:
        - insights_needs_reboot is defined
        - insights_needs_reboot
      block:
        - name: Reboot system
          shell: sleep 2 && shutdown -r now \\"Ansible triggered reboot\\"
          async: 1
          poll: 0
          ignore_errors: true

        - name: Wait for system to boot up
          local_action:
            module: wait_for
            host: \\"{{ hostvars[inventory_hostname]['ansible_host'] | default(hostvars[inventory_hostname]['ansible_ssh_host'], true) | default(inventory_hostname, true) }}\\"
            port: \\"{{ hostvars[inventory_hostname]['ansible_port'] | default(hostvars[inventory_hostname]['ansible_ssh_port'], true) | default('22', true) }}\\"
            delay: 15
            search_regex: OpenSSH
            timeout: 300
          become: false

- name: run insights
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;

exports[`playbooks playbook for remediation with test namespace 1`] = `
"---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# test namespace
# https://console.redhat.com/insights/remediations/5e6d136e-ea32-46e4-a350-325ef41790f4
# Generated by Red Hat Insights on Sat, 29 Dec 2018 08:20:35 GMT
# Created by testReadSingleUser

# Fixes test:ping
# Identifier: (test:ping,fix)
# Version: unknown
- name: ping
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com,9dae9304-86a8-4f66-baa3-a1b27dfdd479.ansible.example.com\\"
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlZCZDFWQldVaHBSM0ZqZG5jMU9FUXJhalZ3VGtGUmFrTXpRUzh6VVdwUVow
      MXZTM0JYZFZVeWNuaExWVkpJYTI5VVRHVkdTRmczVDFkVU1Ya0tlRzR6WWtOMU1FeHdXRWhDWjBk
      Vkt6VndTRFF3ZGswdmMzVlhjblJZYjNJckwydHRja3BFWkZWMU5IWkpaMmt4VW1aQmNsTmxabk5H
      TTFCdlIxWnFjUW8yWkhVM1RuQmhOazlQT1cxWFJGWXZPRnBqYW14SVdrVkpUVU5OYlRKamRqQnVk
      RmhuWTJwSmJrTmhlbmtyTVhkNmFHaExUMFJNV1RKTE9WZ3dPVUkzQ2xKR01HMWpjR0ZpUVZsclJH
      ZHpWVVYyU0RCM2RXUTRkRkpuZW5sWVFXWTJZMmw0TTBabVoyOTVTa2d2ZUdFd01uWkZRbFZGUWxG
      dFUzVlhjMEk0ZHpNS2FXaFVVVVpyVEN0NE1uQnliSGxXUWtWd2FqTnlRMmhZY3poMVVsbEJMeTlU
      UjNka1owSndkMlpVWm01ckswUk5VVGRuUzJKbFYyVnhabFFyVlRNNUt3cGFaMGhoTW1WbFkzZFJh
      MmhsVEUwNFkzVkhha012ZFVFNVpWSnhablJRY1RCcU0yVllNWGxGYjNOR1pHTldOekJuYzFJd1dH
      TjBSazlDWTJWSVVXNXRDak4xVjBSVVRqRmllV0kyWVZaYVFqZzVUM1JWTjFCU1preHhSMVkyYjBj
      MU5WQkZVRkV6VVRCSVRXMVRlRWt3WlRjNWNIUXhXVmxHUkhad2FtNXBjSGtLTjJ0aUwzbERObU5s
      ZFZGTWNraHpLMjVSYkVKQ05VSk5OV0ZQVFN0emMwSkpSM1JJZGtWUFRqWTFOMGw2WlRKaGNqRnBj
      bTh5Y1V4TVFXRkJVMHBrVEFwbU9ERmlPSGxFY1hCeVpFOVZaV1ZMYzBncldYazFhekZGVVUwdlRE
      QXpjeTkzVm1wa1NqQktiV2xFVlhwd1pXa3dkVXRCYmxGUWRFdElRbFJsYmtsSENtRnBMMU5KYlRO
      RWMxcHlNRTV4TnpsYVVWVjBiVEpYY0c5bGVrTkZla3ByVlN0eU4weFhjRWg1Y21SdE5VMVpOVzV4
      TW1sb2JsaEVNRFZHTkhsbGIwVUtObmh4VlRGYWJDdERXSEZOYTNOblJUWklZV0l2VDFscVpHRmFX
      VUZwUm5aUlJFOXhPVkU1V1ZVNE5rSnRXSGRwUzNoalltNVRWREJ6VnpZeFVUaFpWd3BWVUVSblpT
      dFJMMHhSUFQwS1BVVnpWVWNLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - ping:

# Fixes test:reboot
# Identifier: (test:reboot,fix)
# Version: unknown
- name: Trigger reboot
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBSekk0ZG5jMU9FUXJhalZ3VGtGUmFuTkpkeTg1U0hsSlEy
      UTBWRVZPVURobldHbzVSRE5xVVZwVldqSk9iVUk0UVV4NmVrRUtiMFJOYTBkcFZHVXJjWEJTTW1k
      dUszVTVXall2VlRSTlVVcHJMell5TTFOa1pGZzVaRzU0ZHpVd0swaE1hV2xLYUhCQllrdDFPRVpY
      ZEhGc00yWTJiUXBuTkM5UGNuaE1SRWhNV2swMWIxbFZjRE5pUkZkSmJHWTFPRlowV2xNd2N6Wkdi
      R1JSUTBjM2NVMDRXalZUTkZkMGQwcFZLMUZuUlcxc2FDOVNTSFI0Q25CbGFEQkhXVEJuYWs4M2Rq
      Vk1halpSU0hGMVpFUjZkblJzZEhVeE5HdFNVR2RUVkdaMVFUbFpjVVU1WVRKd1ZFMWlZMFJqY1Rk
      UmQzSnlNSGQwUjJRS09UQkJiMVJ5U1dWSWFsWm5SMEU0VjJKbmNUZGhjVTh2TWpadmIyOUVRVGh1
      YjJrek55c3pOMWtyVUVwS01GTTROMmN5T0M5Rk1UZHhWM1JwZW1Obkt3cHlSMVpOYnpWcmJYSjBU
      bVJ2VVhoM1ZTdHpkblpzWjNFMGJsb3hkMHRhT0VoNGRtNW5la3A0VEdGcGFGbzRXakJTUWxJeVNX
      TXJWM2xhYUhJeWFGRTBDa015U25aalduQkVObk56VkdzckswcGpTSHBPUldSeWRFOXVkbVZxU3k5
      b2VIVnZNMXB6Um1SWlptUjBUeloxVUZsU1EwOUJWa3hRWVhOaVNrZFVVR3NLZDJsME1EbHZjblpP
      Tkc4M2NVOVhiRVJFUkhwQmFYWkhia3cyVjFGT09EbDJlRWg1U1ZCQmFsTmxUakJpUjNrM05HWnJT
      VFo2ZVdGNFNtaDJkR3dyVEFwR1kzQm5UWGd5UzBSeFEyRk1abWQzVEd0T2FsaDBaVGhFWkZBeGVD
      ODJiMXBFTnk5dmRtMDVNVEZOTmtOVmVIRnNaa0Z5Vm10UE5sUlhNekJpUVZSeUNtVlplaXQ2TTFa
      a04xVnZNWFpaVFZKaksxbEhTa051ZG1kakwyOXNWR0ZzWW14SVRTdFlVRkpSZG10amNVaERRa0Uz
      T1dNeFJWUk9VbGhDUVVGWmNsTUtTVVZCSzI0MGFFWm9XVTFyU0hsd1JWSnVRV2h0VkVwWGRVbG5h
      MnB6VmpBNWRrZEZjMmxUUlZablVYVjNTVmczYVVkdE0yVlJTMk51WkZSRlEyaFlUQXA2TUd4Sldq
      ZDFhSE5WY3owS1BVTmpjRzBLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: Trigger reboot
      set_fact:
        insights_needs_reboot: true

# Automatic system reboot was suppressed for this playbook.
# This play lists the systems that need to be rebooted manually for the changes to take effect.
- name: Reboot reminder
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com\\"
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRekZ6ZG5jMU9FUXJhalZ3VGtGUmFHaDNkeTh2VVV4SFJE
      aFFNM1l3VlhKWmRFUldabGhaUWxWSFNGQkpUbkpNV1ZCNFFUUUtXWFJXUmtFd1ZXb3diWGhyVVVG
      RFNtbHNZbVJGYVVWdVJIaFVZMVpDZDFSMlpVd3dTVWR0Um5sVVZVWkRVVEZ6WkdRMVUwc3JRMlJy
      TjJKa2RHTmliQW81TlRkaWJtZzVXbk5xYm14dWEwOU5ObTlyVFhVNFNraDZSMDFRV1hST01VaHdR
      VGxJYVV4Mk9IaEdPSFYzTmtkMWQycE9PREJ5ZDNaMmVIZG1WWEpOQ2psWFdYZE1PVU51UzJaRk16
      QnVOM04wTDA1TGJFbDFMMmd3Y2pKU1JTc3hPV1Z0TUdodVJsQmhaa2RwT1RZeWRXaFVTRGhZYzB4
      VWVHOXlRekZhU0c4S09VeENlRU5PVWsxc1draGljVGhzYVd0UVJsaFBhekkxTlNzdmFXMUdkazlE
      V1hwT1RuRXpkVkYxTDB0SWFGTTVhemRaT0Vwb0wyRjZTRFYzYW5KNlV3cDNNekJ1Y25JeVNVOW1j
      V0V2VUdWRlJXOU5SbUV3UVV4WWRFZFVSREpyWmk5Q1pIVXlSemRUU0hkMFNsaG9VbEJzVnpKNU9H
      MW1Za2wwY0UxYWMyTlFDbFp2WkhoVmEwbGtkVXhUTmpaM04wODBPRTVRT1V0Uk9XbE9Wa2hCTVdo
      NVZTOTFWekkwT1ZFd2EwWjZlR3BEUVhsR1QwY3pabkZRUkhWaWNVeFlkbkFLTjB0bFJGWklRbFpS
      UVVkckwwUnhSMFpYT0hoMlVUUkZkSEpVTldrMlVsb3hVRlJMZEZCVmNrVmpRV2hoU2xsWlMwRm9X
      U3R4Y2pkUE1WSkhkazFxUlFwTlEzbFFjVlZ1U0hJMFNHSmtjelJTU0drNVJucFFaeXN2VjB0M2F6
      VnRhMUJMTUUxaEsyMUxkVXd5YTI1elUwaDFTakEzVkVVMk1HNU1WbGM0YTFwakNsSllibGxCU1ZB
      d1RGUnRUMHhvWms0NWJtdzVOM2hvUTNSUFdrZFBjMVp3WVhWdlIyZENOV0ZrV1ZGYVZXY3JSVzF0
      UldSQ1ZrdDZOVUp2VERWc1pYTUtVMjVQVkd3dmFEbG9hekpqYm0xVVdWRTFRa1JoY1RSdGR6QnFS
      SGhDTjFWUWNVdDFZazFDUTJoSVdIUnRVRFpGT1hSU1pYRnNiWHB0YWxkR2QxWnpZd3B1TDBGRFpW
      ZzFZVUUxY3owS1BXZHFZbWdLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - debug:
        msg: \\"Automatic system reboot was suppressed for this playbook. Reboot {{inventory_hostname}} manually for the changes to take effect.\\"
      when:
        - insights_needs_reboot is defined
        - insights_needs_reboot

- name: run insights
  hosts: \\"1040856f-b772-44c7-83a9-eea4813c4be8.ansible.example.com,9dae9304-86a8-4f66-baa3-a1b27dfdd479.ansible.example.com\\"
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false"
`;
